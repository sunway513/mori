

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MORI-IO Introduction &mdash; MORI 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MORI-IO Benchmark" href="MORI-IO-BENCHMARK.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #C00000" >

          
          
          <a href="index.html" class="icon icon-home">
            MORI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-methods">Installation Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#from-source">From Source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verification">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#basic-communication-example">Basic Communication Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#all-gather-example">All-Gather Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#profiling-example">Profiling Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#performance-tips">Performance Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">MORI-IO Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-concepts">Design &amp; Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#workflow">Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-api-quick-reference">Python API Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-basic-read-write">Example: Basic Read/Write</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-configuration">Environment &amp; Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#source-files">Source Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MORI-IO-BENCHMARK.html">MORI-IO Benchmark</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MORI-IO-BENCHMARK.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-IO-BENCHMARK.html#benchmark-commands">Benchmark Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-IO-BENCHMARK.html#benchmark-arguments">Benchmark Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-IO-BENCHMARK.html#results-thor2-rdma-read">Results: Thor2 RDMA Read</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-IO-BENCHMARK.html#results-thor2-rdma-write">Results: Thor2 RDMA Write</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MORI-IO-BENCHMARK.html#message-size-sweep">Message Size Sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="MORI-IO-BENCHMARK.html#batch-size-sweep">Batch Size Sweep</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MORI-IO-BENCHMARK.html#results-cx7-rdma-batch-size-1">Results: CX7 RDMA (Batch Size = 1)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MORI-IO-BENCHMARK.html#write">Write</a></li>
<li class="toctree-l3"><a class="reference internal" href="MORI-IO-BENCHMARK.html#read">Read</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MORI-EP-BENCHMARK.html">MORI-EP Benchmark</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MORI-EP-BENCHMARK.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-EP-BENCHMARK.html#intra-node">Intra-node</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-EP-BENCHMARK.html#inter-node">Inter-node</a></li>
<li class="toctree-l2"><a class="reference internal" href="MORI-EP-BENCHMARK.html#nic-selection">NIC Selection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PROFILER.html">MORI-VIZ (Visualizer)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PROFILER.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="PROFILER.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="PROFILER.html#instrumentation">Instrumentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#include-headers">1. Include Headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#define-profiler-context">2. Define Profiler Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#add-trace-points">3. Add Trace Points</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PROFILER.html#build-code-generation">Build &amp; Code Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#enabling-the-profiler">Enabling the Profiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#code-generation">Code Generation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PROFILER.html#python-analysis">Python Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#device-side-elapsed-time-measurement">Device-side Elapsed Time Measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="PROFILER.html#viewing-the-trace">Viewing the Trace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PROFILER.html#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/communication.html">Communication Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#all-reduce">All-Reduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#all-gather">All-Gather</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#reduce-scatter">Reduce-Scatter</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#broadcast">Broadcast</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#barrier">Barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#send-recv">Send/Recv</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/communication.html#performance-characteristics">Performance Characteristics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/profiler.html">Profiler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/profiler.html#starting-the-profiler">Starting the Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/profiler.html#saving-results">Saving Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/profiler.html#analyzing-results">Analyzing Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/profiler.html#context-manager">Context Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/profiler.html#advanced-features">Advanced Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/profiler.html#visualization">Visualization</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #C00000" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MORI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MORI-IO Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/MORI-IO-INTRO.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mori-io-introduction">
<h1>MORI-IO Introduction<a class="headerlink" href="#mori-io-introduction" title="Link to this heading"></a></h1>
<p>MORI-IO is AMD’s point-to-point communication library that leverages GDR (GPU Direct RDMA) to achieve low-latency and high-bandwidth. Its current main use case is KVCache transfer in LLM inference.</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#design--concepts"><span class="xref myst">Design &amp; Concepts</span></a></p></li>
<li><p><a class="reference internal" href="#workflow"><span class="xref myst">Workflow</span></a></p></li>
<li><p><a class="reference internal" href="#architecture"><span class="xref myst">Architecture</span></a></p></li>
<li><p><a class="reference internal" href="#python-api-quick-reference"><span class="xref myst">Python API Quick Reference</span></a></p></li>
<li><p><a class="reference internal" href="#example-basic-readwrite"><span class="xref myst">Example: Basic Read/Write</span></a></p></li>
<li><p><a class="reference internal" href="#environment--configuration"><span class="xref myst">Environment &amp; Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#source-files"><span class="xref myst">Source Files</span></a></p></li>
</ul>
</section>
<section id="design-concepts">
<h2>Design &amp; Concepts<a class="headerlink" href="#design-concepts" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>IOEngine</strong>: The primary interface for interacting with MORI-IO. It abstracts low-level details of P2P communications and provides high-level APIs for engine registration, memory registration, P2P transfer, etc.</p></li>
<li><p><strong>Backend</strong>: A backend represents and manages a specific transfer medium (e.g., RDMA, XGMI, TCP). It must be created before any data transfer can occur over that medium.</p></li>
<li><p><strong>Engine Registration</strong>: Before two engines can communicate, the remote engine must be registered with the local engine. This establishes the necessary context for initiating data transfers between them.</p></li>
<li><p><strong>Memory Registration</strong>: Application memory must be registered with a local engine before it can participate in data transfer. This ensures the engine can access and manage the memory efficiently during communication.</p></li>
<li><p><strong>Read/Write</strong>: One-sided transfer operations initiated by the initiator engine without active involvement from the target engine. These operations can move data directly between registered memory regions.</p></li>
<li><p><strong>Batch Read/Write</strong>: A batched form of one-sided operations, where multiple transfers are grouped and launched together. Batching reduces per-operation launch overhead and improves bandwidth utilization.</p></li>
<li><p><strong>Session</strong>: A pre-established transfer context between a pair of MemoryDesc objects. Sessions eliminate repetitive overheads such as connection setup, metadata exchange, and resource management, providing a lightweight and efficient path for repeated transfers.</p></li>
</ul>
</section>
<section id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Link to this heading"></a></h2>
<p>The image below shows a typical workflow of using MORI-IO.</p>
<img src="mori_io_workflow.jpg">
</section>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Link to this heading"></a></h2>
<p>From the application’s perspective, MORI-IO provides 3 kinds of functionalities: engine registration, memory registration, and transfers.</p>
<p>The application is responsible for passing and registering engine descriptors among engines where transfers are expected to happen. Once engines are registered with each other, the application registers memory buffers on both initiator-side and target-side. Before initiating transfers from the initiator, the application needs to first pass the memory descriptors from the target side to the initiator side. After that, the application is ready to initiate transfers from the initiator engine. The transfer APIs return a <code class="docutils literal notranslate"><span class="pre">TransferStatus</span></code> that the application can use to query the state of corresponding transfers. Transfers are initiated asynchronously.</p>
<p>Inside MORI-IO, there are 5 components:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Slow Control Plane</strong></p></td>
<td><p>Exchanges metadata such as memory descriptors, RDMA QP numbers, and custom notification messages. Uses a built-in TCP server with a lightweight protocol (no 3rd-party libraries).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Fast Control Plane</strong></p></td>
<td><p>Exchanges metadata on the critical path of transfers (e.g., remote engine completion notifications). Uses RDMA network to minimize performance penalty.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Data Plane</strong></p></td>
<td><p>Transfers bulk data. Supported transports: RDMA, XGMI, TCP.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Metadata Store</strong></p></td>
<td><p>Manages per-engine metadata. Each engine manages its own metadata (no centralized store).</p></td>
</tr>
<tr class="row-even"><td><p><strong>Transport Store</strong></p></td>
<td><p>Manages multiple transfer backends (RDMA, TCP, XGMI). Provides failover if one backend is in a failure state.</p></td>
</tr>
</tbody>
</table>
<img src="mori_io_arch.png">
</section>
<section id="python-api-quick-reference">
<h2>Python API Quick Reference<a class="headerlink" href="#python-api-quick-reference" title="Link to this heading"></a></h2>
<p><strong>Imports:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mori.io</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">IOEngine</span><span class="p">,</span> <span class="n">IOEngineSession</span><span class="p">,</span> <span class="n">IOEngineConfig</span><span class="p">,</span>
    <span class="n">BackendType</span><span class="p">,</span> <span class="n">MemoryLocationType</span><span class="p">,</span> <span class="n">StatusCode</span><span class="p">,</span> <span class="n">PollCqMode</span><span class="p">,</span>
    <span class="n">RdmaBackendConfig</span><span class="p">,</span> <span class="n">XgmiBackendConfig</span><span class="p">,</span>
    <span class="n">EngineDesc</span><span class="p">,</span> <span class="n">MemoryDesc</span><span class="p">,</span>
    <span class="n">set_log_level</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Core classes:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IOEngine</span></code></p></td>
<td><p>Primary engine for P2P transfers — create backends, register engines/memory, issue transfers</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">IOEngineSession</span></code></p></td>
<td><p>Lightweight reusable session between two memory regions, lower per-transfer overhead</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IOEngineConfig</span></code></p></td>
<td><p>Engine configuration: <code class="docutils literal notranslate"><span class="pre">host</span></code> (str), <code class="docutils literal notranslate"><span class="pre">port</span></code> (int)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RdmaBackendConfig</span></code></p></td>
<td><p>RDMA backend config: <code class="docutils literal notranslate"><span class="pre">qp_per_transfer</span></code>, <code class="docutils literal notranslate"><span class="pre">post_batch_size</span></code>, <code class="docutils literal notranslate"><span class="pre">num_worker_threads</span></code>, <code class="docutils literal notranslate"><span class="pre">poll_cq_mode</span></code>, <code class="docutils literal notranslate"><span class="pre">enable_notification</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">XgmiBackendConfig</span></code></p></td>
<td><p>XGMI backend config: <code class="docutils literal notranslate"><span class="pre">num_streams</span></code> (default 64), <code class="docutils literal notranslate"><span class="pre">num_events</span></code> (default 64)</p></td>
</tr>
</tbody>
</table>
<p><strong>Enums:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Enum</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BackendType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Unknown</span></code>, <code class="docutils literal notranslate"><span class="pre">XGMI</span></code>, <code class="docutils literal notranslate"><span class="pre">RDMA</span></code>, <code class="docutils literal notranslate"><span class="pre">TCP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MemoryLocationType</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Unknown</span></code>, <code class="docutils literal notranslate"><span class="pre">CPU</span></code>, <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">StatusCode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code>, <code class="docutils literal notranslate"><span class="pre">INIT</span></code>, <code class="docutils literal notranslate"><span class="pre">IN_PROGRESS</span></code>, <code class="docutils literal notranslate"><span class="pre">ERR_INVALID_ARGS</span></code>, <code class="docutils literal notranslate"><span class="pre">ERR_NOT_FOUND</span></code>, <code class="docutils literal notranslate"><span class="pre">ERR_RDMA_OP</span></code>, <code class="docutils literal notranslate"><span class="pre">ERR_BAD_STATE</span></code>, <code class="docutils literal notranslate"><span class="pre">ERR_GPU_OP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PollCqMode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">POLLING</span></code>, <code class="docutils literal notranslate"><span class="pre">EVENT</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>IOEngine methods:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_engine_desc()</span></code></p></td>
<td><p>Get engine descriptor for remote registration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">create_backend(type,</span> <span class="pre">config)</span></code></p></td>
<td><p>Create RDMA/XGMI/TCP backend</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">remove_backend(type)</span></code></p></td>
<td><p>Remove a backend</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">register_remote_engine(desc)</span></code></p></td>
<td><p>Register a remote engine</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">deregister_remote_engine(desc)</span></code></p></td>
<td><p>Deregister a remote engine</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">register_memory(ptr,</span> <span class="pre">size,</span> <span class="pre">device_id,</span> <span class="pre">mem_loc)</span></code></p></td>
<td><p>Register memory by raw pointer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">register_torch_tensor(tensor)</span></code></p></td>
<td><p>Register a PyTorch tensor</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">deregister_memory(mem_desc)</span></code></p></td>
<td><p>Deregister memory</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">allocate_transfer_uid()</span></code></p></td>
<td><p>Allocate unique transfer ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">read(local_mem,</span> <span class="pre">l_offset,</span> <span class="pre">remote_mem,</span> <span class="pre">r_offset,</span> <span class="pre">size,</span> <span class="pre">uid)</span></code></p></td>
<td><p>One-sided read (remote → local)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">write(local_mem,</span> <span class="pre">l_offset,</span> <span class="pre">remote_mem,</span> <span class="pre">r_offset,</span> <span class="pre">size,</span> <span class="pre">uid)</span></code></p></td>
<td><p>One-sided write (local → remote)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">batch_read(...)</span></code> / <code class="docutils literal notranslate"><span class="pre">batch_write(...)</span></code></p></td>
<td><p>Batched transfers</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">create_session(local_mem,</span> <span class="pre">remote_mem)</span></code></p></td>
<td><p>Create reusable session</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pop_inbound_transfer_status(key,</span> <span class="pre">uid)</span></code></p></td>
<td><p>Check inbound transfer status</p></td>
</tr>
</tbody>
</table>
<p><strong>TransferStatus methods:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">InProgress()</span></code></p></td>
<td><p>Transfer still in progress</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Succeeded()</span></code></p></td>
<td><p>Transfer completed successfully</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Failed()</span></code></p></td>
<td><p>Transfer failed</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Code()</span></code></p></td>
<td><p>Get status code</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Message()</span></code></p></td>
<td><p>Get status message</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Wait()</span></code></p></td>
<td><p>Block until transfer completes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="example-basic-read-write">
<h2>Example: Basic Read/Write<a class="headerlink" href="#example-basic-read-write" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mori.io</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">IOEngine</span><span class="p">,</span> <span class="n">IOEngineConfig</span><span class="p">,</span> <span class="n">BackendType</span><span class="p">,</span>
    <span class="n">RdmaBackendConfig</span><span class="p">,</span> <span class="n">EngineDesc</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create engines on initiator and target</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">IOEngineConfig</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
<span class="n">initiator</span> <span class="o">=</span> <span class="n">IOEngine</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;initiator&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">8081</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">IOEngine</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Create RDMA backends</span>
<span class="n">rdma_config</span> <span class="o">=</span> <span class="n">RdmaBackendConfig</span><span class="p">(</span><span class="n">qp_per_transfer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">initiator</span><span class="o">.</span><span class="n">create_backend</span><span class="p">(</span><span class="n">BackendType</span><span class="o">.</span><span class="n">RDMA</span><span class="p">,</span> <span class="n">rdma_config</span><span class="p">)</span>
<span class="n">target</span><span class="o">.</span><span class="n">create_backend</span><span class="p">(</span><span class="n">BackendType</span><span class="o">.</span><span class="n">RDMA</span><span class="p">,</span> <span class="n">rdma_config</span><span class="p">)</span>

<span class="c1"># Exchange and register engine descriptors</span>
<span class="n">initiator_desc</span> <span class="o">=</span> <span class="n">initiator</span><span class="o">.</span><span class="n">get_engine_desc</span><span class="p">()</span>
<span class="n">target_desc</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">get_engine_desc</span><span class="p">()</span>
<span class="n">initiator</span><span class="o">.</span><span class="n">register_remote_engine</span><span class="p">(</span><span class="n">target_desc</span><span class="p">)</span>
<span class="n">target</span><span class="o">.</span><span class="n">register_remote_engine</span><span class="p">(</span><span class="n">initiator_desc</span><span class="p">)</span>

<span class="c1"># Register GPU tensors</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 1 MB</span>
<span class="n">src_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">dst_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:1&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">initiator_mem</span> <span class="o">=</span> <span class="n">initiator</span><span class="o">.</span><span class="n">register_torch_tensor</span><span class="p">(</span><span class="n">dst_tensor</span><span class="p">)</span>
<span class="n">target_mem</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">register_torch_tensor</span><span class="p">(</span><span class="n">src_tensor</span><span class="p">)</span>

<span class="c1"># Read: copy from target (remote) to initiator (local)</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">initiator</span><span class="o">.</span><span class="n">allocate_transfer_uid</span><span class="p">()</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">initiator</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">initiator_mem</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">target_mem</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

<span class="c1"># Wait for completion</span>
<span class="k">while</span> <span class="n">status</span><span class="o">.</span><span class="n">InProgress</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="k">assert</span> <span class="n">status</span><span class="o">.</span><span class="n">Succeeded</span><span class="p">()</span>

<span class="c1"># With sessions (lower overhead for repeated transfers)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">initiator</span><span class="o">.</span><span class="n">create_session</span><span class="p">(</span><span class="n">initiator_mem</span><span class="p">,</span> <span class="n">target_mem</span><span class="p">)</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">allocate_transfer_uid</span><span class="p">()</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>
<span class="k">while</span> <span class="n">status</span><span class="o">.</span><span class="n">InProgress</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/io/example.py</span></code> for more complete examples including batch transfers.</p>
</section>
<section id="environment-configuration">
<h2>Environment &amp; Configuration<a class="headerlink" href="#environment-configuration" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">set_log_level(level)</span></code></p></td>
<td><p>Set MORI-IO log verbosity level</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RdmaBackendConfig.qp_per_transfer</span></code></p></td>
<td><p>Queue pairs per transfer (default 1, increase for higher bandwidth)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RdmaBackendConfig.poll_cq_mode</span></code></p></td>
<td><p>CQ polling mode: <code class="docutils literal notranslate"><span class="pre">POLLING</span></code> (busy-wait, lower latency) or <code class="docutils literal notranslate"><span class="pre">EVENT</span></code> (interrupt-driven)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RdmaBackendConfig.enable_notification</span></code></p></td>
<td><p>Enable target-side completion notifications (default <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IOEngineConfig.port</span> <span class="pre">=</span> <span class="pre">0</span></code></p></td>
<td><p>Auto-bind to a free port</p></td>
</tr>
</tbody>
</table>
</section>
<section id="source-files">
<h2>Source Files<a class="headerlink" href="#source-files" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>File</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">python/mori/io/__init__.py</span></code></p></td>
<td><p>Public exports</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">python/mori/io/engine.py</span></code></p></td>
<td><p>Python IOEngine and IOEngineSession classes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">src/pybind/mori.cpp</span></code></p></td>
<td><p>C++ Python bindings (IO section)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">examples/io/example.py</span></code></p></td>
<td><p>Complete usage examples (read, write, batch, session)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tests/python/io/test_engine.py</span></code></p></td>
<td><p>Comprehensive test suite</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tests/python/io/benchmark.py</span></code></p></td>
<td><p>Performance benchmark</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">docs/MORI-IO-BENCHMARK.md</span></code></p></td>
<td><p>Benchmark commands and results</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MORI-IO-BENCHMARK.html" class="btn btn-neutral float-right" title="MORI-IO Benchmark" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, AMD.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>