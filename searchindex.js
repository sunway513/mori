Search.setIndex({"alltitles": {"1. Concepts": [[4, "concepts"]], "1. Include Headers": [[5, "include-headers"]], "1. Kernel Types": [[1, "kernel-types"]], "10. Profiling with MORI-VIZ": [[1, "profiling-with-mori-viz"]], "11. Framework Integration": [[1, "framework-integration"]], "2. Configuration": [[1, "configuration"]], "2. Define Profiler Context": [[5, "define-profiler-context"]], "2. Initialization": [[4, "initialization"]], "3. Add Trace Points": [[5, "add-trace-points"]], "3. Operator API": [[1, "operator-api"]], "3. Query APIs": [[4, "query-apis"]], "4. Memory Management": [[4, "memory-management"]], "4. Standard MoE Compatibility (DeepEP)": [[1, "standard-moe-compatibility-deepep"]], "5. Initialization": [[1, "initialization"]], "5. P2P Address Translation": [[4, "p2p-address-translation"]], "6. Launch Configuration": [[1, "launch-configuration"]], "6. Synchronization": [[4, "synchronization"]], "7. Complete Example": [[1, "complete-example"]], "7. HIP Module Init (Triton Integration)": [[4, "hip-module-init-triton-integration"]], "8. Environment Variables": [[1, "environment-variables"]], "8. Initialization Flags": [[4, "initialization-flags"]], "9. Benchmarking": [[1, "benchmarking"]], "API Reference": [[8, null]], "Advanced Features": [[7, "advanced-features"]], "All-Gather": [[6, "all-gather"]], "All-Gather Example": [[10, "all-gather-example"]], "All-Reduce": [[6, "all-reduce"]], "Allocating Symmetric Memory": [[4, "allocating-symmetric-memory"]], "Analyzing Results": [[7, "analyzing-results"]], "Architecture": [[3, "architecture"]], "Auto Mode": [[1, "auto-mode"]], "Barrier": [[6, "barrier"]], "Basic Communication Example": [[10, "basic-communication-example"]], "Batch Size Sweep": [[2, "batch-size-sweep"]], "Benchmark Arguments": [[2, "benchmark-arguments"]], "Benchmark Commands": [[2, "benchmark-commands"]], "Best Practices": [[5, "best-practices"]], "Broadcast": [[6, "broadcast"]], "Build & Code Generation": [[5, "build-code-generation"]], "Build Options": [[1, "build-options"]], "Code Generation": [[5, "code-generation"]], "Communication Operations": [[6, null]], "Context Manager": [[7, "context-manager"]], "Design & Concepts": [[3, "design-concepts"]], "Device-side Elapsed Time Measurement": [[5, "device-side-elapsed-time-measurement"]], "Enabling the Profiler": [[5, "enabling-the-profiler"]], "Environment & Configuration": [[3, "environment-configuration"]], "Environment Variables": [[4, "environment-variables"], [9, "environment-variables"]], "EpDispatchCombineConfig": [[1, "epdispatchcombineconfig"]], "EpDispatchCombineOp": [[1, "epdispatchcombineop"]], "Example: Basic Read/Write": [[3, "example-basic-read-write"]], "Features": [[8, null], [8, "features"]], "Finalization": [[4, "finalization"]], "Freeing Symmetric Memory": [[4, "freeing-symmetric-memory"]], "From Source": [[9, "from-source"]], "Getting Help": [[8, "getting-help"]], "Getting Started": [[8, null]], "Indices and tables": [[8, "indices-and-tables"]], "Installation": [[9, null]], "Installation Methods": [[9, "installation-methods"]], "Instrumentation": [[5, "instrumentation"]], "Inter-node": [[0, "inter-node"], [1, "inter-node"]], "Intra-node": [[0, "intra-node"], [1, "intra-node"]], "MORI Documentation": [[8, null]], "MORI Shmem Guide": [[4, null]], "MORI-EP Benchmark": [[0, null]], "MORI-EP User Guide": [[1, null]], "MORI-IO Benchmark": [[2, null]], "MORI-IO Introduction": [[3, null]], "MORI-VIZ (Visualizer)": [[5, null]], "Manual Mode (Default)": [[1, "manual-mode-default"]], "Message Size Sweep": [[2, "message-size-sweep"]], "Method 1: PyTorch Process Group (Recommended)": [[1, "method-1-pytorch-process-group-recommended"], [4, "method-1-pytorch-process-group-recommended"]], "Method 2: Unique ID (No PyTorch Distributed)": [[1, "method-2-unique-id-no-pytorch-distributed"]], "Method 2: Unique ID (Standalone)": [[4, "method-2-unique-id-standalone"]], "NIC Selection": [[0, "nic-selection"]], "Next Steps": [[10, "next-steps"]], "Overview": [[5, "overview"]], "Performance Characteristics": [[6, "performance-characteristics"]], "Performance Tips": [[10, "performance-tips"]], "Processing Element (PE)": [[4, "processing-element-pe"]], "Profiler": [[7, null]], "Profiling Example": [[10, "profiling-example"]], "Python API Quick Reference": [[3, "python-api-quick-reference"]], "Python Analysis": [[5, "python-analysis"]], "Quick Links": [[8, "quick-links"]], "Quick Reference": [[1, "quick-reference"], [4, "quick-reference"]], "Quickstart": [[10, null]], "Read": [[2, "read"]], "Reduce-Scatter": [[6, "reduce-scatter"]], "Reference Performance (DeepSeek V3 config)": [[1, "reference-performance-deepseek-v3-config"]], "Registering Existing Buffers": [[4, "registering-existing-buffers"]], "Requirements": [[9, "requirements"]], "Results: CX7 RDMA (Batch Size = 1)": [[2, "results-cx7-rdma-batch-size-1"]], "Results: Thor2 RDMA Read": [[2, "results-thor2-rdma-read"]], "Results: Thor2 RDMA Write": [[2, "results-thor2-rdma-write"]], "Saving Results": [[7, "saving-results"]], "Send/Recv": [[6, "send-recv"]], "Source Files": [[1, "source-files"], [3, "source-files"], [4, "source-files"]], "Split dispatch/combine (send + recv)": [[1, "split-dispatch-combine-send-recv"]], "Starting the Profiler": [[7, "starting-the-profiler"]], "Supported GPUs": [[8, "supported-gpus"]], "Symmetric Heap": [[4, "symmetric-heap"]], "Symmetric Memory": [[4, "symmetric-memory"]], "Table of Contents": [[0, "table-of-contents"], [1, "table-of-contents"], [2, "table-of-contents"], [3, "table-of-contents"], [4, "table-of-contents"], [5, "table-of-contents"]], "Troubleshooting": [[9, "troubleshooting"]], "Verification": [[9, "verification"]], "Viewing the Trace": [[5, "viewing-the-trace"]], "Visualization": [[7, "visualization"]], "Workflow": [[3, "workflow"]], "Write": [[2, "write"]], "combine()": [[1, "combine"]], "combine_standard_moe()": [[1, "combine-standard-moe"]], "convert_combine_input()": [[1, "convert-combine-input"]], "convert_dispatch_output()": [[1, "convert-dispatch-output"]], "dispatch()": [[1, "dispatch"]], "dispatch_standard_moe()": [[1, "dispatch-standard-moe"]], "get_dispatch_src_token_pos()": [[1, "get-dispatch-src-token-pos"]], "get_registered_combine_input_buffer()": [[1, "get-registered-combine-input-buffer"]], "reset()": [[1, "reset"]]}, "docnames": ["MORI-EP-BENCHMARK", "MORI-EP-GUIDE", "MORI-IO-BENCHMARK", "MORI-IO-INTRO", "MORI-SHMEM-GUIDE", "PROFILER", "api/communication", "api/profiler", "index", "installation", "quickstart"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1}, "filenames": ["MORI-EP-BENCHMARK.md", "MORI-EP-GUIDE.md", "MORI-IO-BENCHMARK.md", "MORI-IO-INTRO.md", "MORI-SHMEM-GUIDE.md", "PROFILER.md", "api/communication.rst", "api/profiler.rst", "index.rst", "installation.rst", "quickstart.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [1, 2, 3, 5, 7, 8], "0": [0, 1, 2, 3, 4, 5, 6, 10], "00": 2, "01": 2, "02": 2, "03": 2, "04": 2, "05": 2, "06": 2, "07": 2, "08": 2, "09": 2, "1": [3, 6, 8, 9], "10": [0, 2], "1024": [2, 3, 4, 6, 10], "1024b": 2, "103": [1, 2], "1048576": 2, "108": 2, "11": 2, "113": 2, "114": 2, "116": 2, "117": 2, "1173": 2, "118": 2, "119": 2, "12": 2, "120": 2, "121": 2, "1234": [0, 1, 2], "1234567890": 7, "12355": 1, "1241": 2, "125": 7, "126": 2, "127": 3, "128": [1, 2, 4, 8], "129": [0, 1, 2], "13": 2, "130": 2, "131072": 2, "132": 2, "134": 2, "1359": 2, "1360": 2, "1399": 2, "14": 2, "1403": 2, "143": 2, "1469": 2, "147": 2, "1488": 2, "1497": 2, "1498": 2, "15": 2, "152": 2, "16": [1, 2], "161": 1, "16384": [2, 5], "16777216": 2, "17": 2, "174": 2, "175": 2, "18": 2, "181": 2, "189": 2, "19": 2, "192": [2, 8], "193": 2, "194": [0, 1, 2], "1kb": 2, "1mb": 2, "2": [0, 2, 8], "20": 2, "200": 2, "202": 2, "2048": 2, "208": 1, "2097152": 2, "21": 2, "22": 2, "23": 2, "2301": 2, "235": 2, "2390": 2, "24": 2, "25": 2, "256": [1, 2, 3, 4, 10], "26": 2, "262144": 2, "268": 2, "27": 2, "275": 2, "2770": 2, "2777": 2, "28": 2, "281": 2, "2856": 2, "2867": 2, "29": 2, "2d": 1, "2g": [1, 4], "3": [2, 3, 7, 8, 9], "30": 2, "307": 1, "31": [2, 7], "32": [1, 2], "324": 2, "32768": 2, "33": 2, "330": 1, "33554432": 2, "336": 2, "34": 2, "344": 2, "35": 2, "36": 2, "37": 2, "371": 2, "374": 2, "379": 2, "38": 2, "39": 2, "3d": 1, "3rd": 3, "4": [2, 5], "40": 2, "4096": [1, 2, 5], "41": 2, "4194304": [2, 7], "42": 2, "43": 2, "44": 2, "447": 2, "45": 2, "458": 2, "4585": 2, "46": 2, "4617": 2, "47": 2, "48": 2, "49": [1, 2], "5": [2, 3, 9, 10], "50": [1, 2], "51": 2, "512": [2, 10], "512m": 4, "52": 2, "524288": 2, "53": 2, "54": 2, "55": 2, "56": 2, "5605": 2, "5622": 2, "57": [1, 2], "58": 2, "59": 2, "599": 2, "6": 2, "60": 2, "61": 2, "611": 2, "62": 2, "63": [1, 2], "64": [1, 2, 3], "64mb": 2, "65": [0, 1, 2], "65536": 2, "66": 2, "67": 2, "67108864": 2, "68": 2, "682": 2, "683": 2, "69": 2, "6g": [1, 4], "7": [2, 9], "70": 2, "71": 2, "715": 2, "7168": [1, 4], "717": 2, "72": 2, "73": 2, "74": 2, "75": 2, "752": 2, "76": 2, "77": 2, "78": 2, "781": 2, "79": 2, "8": [0, 2, 7, 9, 10], "80": 1, "805": 2, "8080": 3, "8081": 3, "81": 2, "8192": 2, "82": 2, "83": 2, "8388608": 2, "84": 2, "85": 2, "86": 2, "87": 2, "88": 2, "89": 2, "8b": 2, "9": 2, "90": 2, "91": [1, 2], "92": 2, "93": 2, "94": 2, "95": 2, "96": [1, 2], "97": 2, "98": 2, "99": 2, "A": [3, 4, 5], "By": 5, "For": [0, 1, 4, 5, 6, 10], "If": [0, 1, 5], "In": 5, "It": [1, 3, 4, 5], "Its": [3, 4], "No": 9, "ON": [1, 5], "One": 3, "The": [0, 1, 3, 4, 5], "Then": 4, "There": [1, 4], "These": [1, 3, 5], "To": [0, 1, 5], "With": 3, "_": [1, 10], "__global__": 5, "__init__": [1, 3, 4], "__main__": 1, "__name__": 1, "__version__": 9, "_c": [1, 4], "_distributed_c10d": [1, 4], "_handl": [1, 5], "_profiler_init_context": 5, "_register_process_group": [1, 4], "about": 10, "abstract": 3, "access": [3, 4, 9], "achiev": 3, "across": [1, 4, 6], "activ": [1, 3], "actual": 0, "address": 1, "advanc": 8, "after": [1, 3, 5], "ai": 8, "aiter": 1, "align": 4, "all": [0, 1, 2, 4, 5, 8], "all_gath": [6, 7, 10], "all_profiler_slot": 5, "all_reduc": [6, 7, 10], "alloc": 3, "allocate_transfer_uid": 3, "allow": 5, "alreadi": 4, "also": 5, "alwai": 4, "amd": [1, 3, 8, 9], "among": 3, "an": 4, "analysi": 8, "analyz": 8, "ani": [1, 3, 4], "anoth": 5, "api": 5, "applic": [3, 4], "ar": [1, 3, 4, 5, 9], "architectur": [8, 9, 10], "arg": [1, 5], "argument": [1, 5, 8], "arithmet": 4, "art": 1, "assert": 3, "assign": 1, "async": 1, "asynchron": 3, "asyncl": 1, "atom": 1, "auto": [3, 5], "automat": [1, 5, 7], "avail": [0, 1, 4, 5, 9], "avg": 2, "avoid": 5, "b": [2, 5], "back": 1, "backend": [1, 3, 4, 10], "backendtyp": 3, "bandwidth": [0, 1, 3, 6, 7, 10], "bandwidth_gbp": 7, "barrier": [4, 7, 8, 10], "base": 1, "baselin": 1, "basic": [4, 8], "batch": [1, 3, 8, 10], "batch_read": 3, "batch_writ": 3, "batchsiz": 2, "befor": [1, 3, 4, 5], "begin": 5, "below": 3, "bench": [0, 1], "bench_dispatch_combin": [0, 1], "benchmark": [3, 8, 10], "best": [6, 8], "between": [1, 3, 5], "bf16": [1, 10], "bfloat16": [1, 4], "bind": [1, 3, 4, 5], "block": [1, 3, 4], "block_num": 1, "blockdim": 5, "blockidx": 5, "bool": 1, "both": [1, 3, 4], "bottleneck": 10, "broadcast": [1, 4, 8], "broadcom": 1, "buffer": [1, 2, 3, 5], "build": [4, 8, 9], "build_io": 1, "build_op": 1, "build_pybind": 1, "build_shmem": 1, "built": [3, 7, 8], "bulk": 3, "busi": 3, "bw": [0, 1, 2], "byte": [1, 2, 4, 7], "c": [1, 3, 4, 5], "calcul": [0, 1, 5], "call": [1, 5], "call_reset": 1, "camelcas": 5, "camelcasefilenam": 5, "can": [0, 1, 3, 5, 7], "captur": 1, "case": [1, 3], "caus": 5, "cd": [0, 1, 2, 9], "cdna": 8, "central": 3, "characterist": 8, "check": 3, "checkpoint": 5, "choos": 1, "chrome": [5, 7], "circular": 5, "class": 3, "clean": 5, "cleanup": [1, 4], "clear": 5, "click": 5, "clone": [1, 9], "cmake": [1, 5], "code": [3, 4, 7, 8], "collect": [1, 6], "com": [8, 9], "combin": [0, 5, 10], "combine_buf": 1, "combine_out": 1, "combine_output": 1, "combine_recv": 1, "combine_send": 1, "combine_w": 1, "combine_weight": 1, "command": [0, 3, 8], "commun": [1, 3, 4, 7, 8], "compil": [4, 5, 9], "complet": 3, "compon": [3, 4], "comprehens": 3, "comput": [1, 5], "concept": 8, "condit": 5, "config": [2, 3, 5], "configur": [5, 8], "connect": [3, 4], "consecut": 2, "consid": 5, "content": 8, "context": [3, 8], "control": [3, 4, 5], "convent": 5, "convers": [1, 5], "convert": [1, 5, 7], "copi": [1, 3, 4, 5], "copy_": 1, "core": [1, 3, 5], "correct": 1, "correspond": [1, 3], "count": 1, "cpp": [1, 3, 4, 5], "cpu": [1, 3, 4], "cpunodebind": 2, "cq": [2, 3], "creat": [1, 3, 5, 10], "create_backend": 3, "create_sess": 3, "critic": 3, "csv": 7, "cu": 1, "cuda": [1, 3, 4, 6, 10], "current": [1, 3, 4], "custom": 3, "cx7": 8, "data": [1, 3, 5, 6, 7], "data_ptr": 4, "data_typ": 1, "dataclass": 1, "debug": [1, 5, 7], "dedic": 1, "def": 1, "default": [0, 3, 4, 5], "del": 1, "deleg": 1, "deliv": 1, "denable_profil": 5, "depend": 9, "deregist": [3, 4], "deregister_memori": 3, "deregister_remote_engin": 3, "deriv": 5, "desc": 3, "descript": [1, 2, 3, 4], "descriptor": 3, "design": [5, 8], "dest_p": 4, "destroi": 4, "destroy_process_group": [1, 4], "detail": [3, 5, 7], "detect": 5, "dev": [1, 2, 5], "develop": [5, 9], "devic": [0, 1, 2, 3, 4, 6, 10], "device_id": [1, 3], "differ": [1, 4], "dim": 1, "dimens": 1, "direct": 3, "directli": [3, 4, 5], "directori": [5, 7], "disabl": 5, "discov": 5, "discuss": 8, "dispatch": 5, "dispatch_": 1, "dispatch_combin": [0, 1], "dispatch_idx": 1, "dispatch_indic": 1, "dispatch_out": 1, "dispatch_out_topk_idx": 1, "dispatch_out_x": 1, "dispatch_output": 1, "dispatch_recv": 1, "dispatch_scal": 1, "dispatch_send": 1, "dispatch_w": 1, "dispatch_weight": 1, "dist": [1, 4], "distribut": [4, 6, 8], "diverg": 5, "do": 5, "doc": [3, 8], "document": 1, "domain": 4, "done": 4, "driven": 3, "dsc": 1, "dst": 6, "dst_tensor": 3, "dtype": [1, 3, 4, 10], "durat": 7, "duration_u": 7, "dure": 3, "dynam": 4, "e": [1, 2, 3, 4, 5], "each": [0, 1, 3, 4, 5], "effici": [3, 8], "element": 1, "element_s": 1, "elimin": 3, "embed": 1, "empti": 1, "enabl": [1, 2, 3, 4, 7, 9, 10], "enable_debug_printf": 1, "enable_notif": 3, "enable_profil": [1, 5], "enable_standard_moe_adapt": 1, "end": 5, "engin": 3, "enginedesc": 3, "ens14np0": [0, 1, 2], "ensur": [3, 5, 9], "entir": 5, "entri": 5, "enum": [3, 5], "environ": [0, 8], "ep": [4, 8], "ep16": 1, "ep32": 1, "ep8": 1, "ep_trac": 1, "epdispatchcombinekerneltyp": 1, "epdispatchcombineop": 5, "err_bad_st": 3, "err_gpu_op": 3, "err_invalid_arg": 3, "err_not_found": 3, "err_rdma_op": 3, "error": 5, "establish": 3, "etc": [1, 3, 4], "evalu": 5, "event": [2, 3, 5], "everi": 4, "exactli": 4, "exampl": [0, 5, 6, 7, 8], "exchang": 3, "exclud": [0, 1, 4], "execut": 5, "exist": 5, "exit": 4, "expans": 5, "expect": 3, "experiment": 8, "expert": 1, "expert_output": 1, "explicit": 5, "export": [0, 1, 2, 3, 4, 5, 9], "export_to_perfetto": [1, 5], "extens": 5, "extern": 1, "extract": 5, "f": [1, 9, 10], "fail": 3, "failov": 3, "failur": 3, "fals": 1, "fast": 3, "featur": [5, 9], "field": 1, "file": [5, 8], "filenam": 5, "filter": 7, "find": 5, "first": [3, 5, 10], "five": 1, "float16": 10, "float32": 1, "float8_e4m3fnuz": 1, "follow": [0, 5], "form": 3, "format": [1, 5, 7], "found": 9, "foundat": 4, "fp16": 10, "fp8": 1, "free": 3, "frequenc": 5, "from": [1, 2, 3, 4, 5, 6], "full": 1, "fulli": 8, "function": [3, 4, 5], "fused_mo": 1, "fusedmo": 1, "fusedmoeparallelconfig": 1, "g": [1, 2, 3, 4, 5], "gather": 8, "gb": [1, 2, 7, 8], "gdr": 3, "gener": [1, 4, 8], "generate_profiler_bind": 5, "get": [1, 3, 4, 5, 10], "get_debug_time_buf": [1, 5], "get_debug_time_offset": 5, "get_engine_desc": 3, "get_world_s": 10, "gfx": 9, "gfx90a": [8, 9], "gfx942": [8, 9], "gfx950": 8, "git": 9, "github": [8, 9], "global": [4, 5], "globalgpust": 4, "globalthdid": 5, "globalwarpid": 5, "gloo": [1, 4], "gloo_socket_ifnam": [0, 1, 2], "goe": 5, "gpu": [1, 3, 4, 5, 9], "gpu_arch": 9, "gpu_freq_ghz": 5, "gpu_per_nod": 1, "gradient": 6, "granular": 5, "grep": 9, "group": 3, "guid": 10, "handl": [1, 5], "happen": 3, "hardwar": [4, 5], "hasattr": [1, 5], "have": 5, "hbm2e": 8, "hbm3": 8, "header": [1, 4], "heap": 1, "helper": 5, "here": [5, 7], "hidden": 1, "hidden_dim": 1, "high": [1, 3, 5, 6, 8], "higher": [1, 3], "hip": 1, "hip_module_handl": 4, "hipdeviceattributewallclockr": 5, "hipdevicegetattribut": 5, "host": [1, 2, 3, 5], "how": 1, "hpp": [1, 5], "http": [8, 9], "i": [1, 3, 4, 5, 8, 9, 10], "id": [3, 5], "ident": 1, "identifi": 10, "if_enable_profil": 5, "ignor": 1, "imag": 3, "immedi": 5, "impact": 5, "implement": 1, "import": [1, 3, 4, 5, 6, 7, 9, 10], "importerror": 9, "improv": 3, "in_progress": 3, "inbound": 3, "includ": [0, 1, 3, 4, 7], "increas": 3, "index": 8, "indic": 1, "infer": [1, 3, 8], "info": 2, "infrastructur": 8, "init": [1, 3], "init_process_group": [1, 4, 10], "initi": [2, 3, 5, 10], "initiator_desc": 3, "initiator_mem": 3, "inprogress": 3, "input": [1, 6, 10], "input_data": 1, "input_tensor": [6, 10], "insid": 3, "instal": [1, 5, 8], "instanc": 5, "instant": 5, "instinct": [8, 9], "instrument": 8, "int": [1, 3, 4, 5, 6], "int32": 1, "integ": 4, "integr": [5, 8], "intens": 5, "inter": 8, "interact": 3, "interfac": [0, 1, 2, 3], "intern": 1, "internod": 1, "internode_v1": [1, 5], "internodev1": [1, 5], "internodev1l": 1, "internodev1slot": 5, "interrupt": 3, "intra": [4, 8], "intranod": 1, "introduct": [8, 10], "invalid": 4, "involv": 3, "io": [1, 4, 8, 10], "ioengin": 3, "ioengineconfig": 3, "ioenginesess": 3, "ip": 0, "is_avail": 9, "issu": [3, 8], "item": [1, 5], "iter": [1, 5], "its": [0, 3, 4], "join": 1, "json": [1, 5, 7, 10], "k": 1, "keep": 5, "kei": [3, 5], "kernel": [4, 5], "kernel_profil": [1, 5], "kernel_typ": 1, "kernelmain": 5, "kind": 3, "know": 5, "kvcach": 3, "l_offset": 3, "lane": 5, "laneid": 5, "larg": [1, 6], "lat": 2, "latenc": [1, 2, 3, 5, 6], "later": 9, "launch": 3, "layer": 4, "layout": 1, "ld_library_path": 9, "learn": 10, "len": 10, "level": [2, 3, 5], "leverag": 3, "lib": 9, "librari": [1, 3, 8, 9], "lightweight": 3, "like": [1, 5], "limit": 5, "list": [6, 10], "ll": 1, "llm": [1, 3], "local": [3, 4], "local_mem": 3, "local_ptr": 4, "localhost": 1, "log": [2, 3, 5, 7], "long": 5, "loop": 5, "low": [1, 3, 5, 6], "low_latency_async": 1, "lower": [2, 3], "m": 7, "machin": 5, "macro": 5, "mai": 5, "main": [3, 5], "manag": [3, 8], "manual": 5, "map": [1, 4, 5], "master": 1, "master_addr": [0, 1, 2], "master_port": [0, 1, 2], "max": [1, 2, 6], "max_num_inp_token_per_rank": 1, "max_token_type_s": 1, "maximum": [1, 2], "mb": [2, 3], "md": [1, 3], "mean": 4, "medium": [3, 6], "mem_desc": 3, "mem_loc": 3, "member": 5, "membind": 2, "memori": [1, 3, 5, 8], "memorydesc": 3, "memorylocationtyp": 3, "memorywait": 5, "merg": 5, "messag": 3, "metadata": 3, "method": [3, 8], "mi200": 9, "mi250x": 8, "mi300": 9, "mi300a": 8, "mi300x": 8, "microsecond": 7, "min": [2, 6], "minim": [3, 5], "minut": 10, "mixtur": 1, "mlx5_0": [0, 1, 4], "mlx5_1": [0, 1, 4], "mlx5_2": [0, 1, 4], "mlx5_3": [0, 1, 4], "mode": [2, 3], "model": [1, 6], "model_op": 1, "modul": [5, 9], "moe_op": 1, "more": 3, "mori": [6, 7, 9, 10], "mori_all2al": 1, "mori_enable_profil": 9, "mori_ep_launch_config_mod": 1, "mori_profil": 10, "mori_rdma_devic": [0, 1, 4], "mori_shmem_heap_s": [1, 4], "mori_shmem_init_with_mpi_comm": 4, "mori_shmem_init_with_uniqueid": [1, 4], "mori_trace_": 5, "mori_trace_inst": 5, "mori_trace_next": 5, "mori_trace_seq": 5, "mori_trace_span": 5, "moriall2allmanag": 1, "move": 3, "mpi": [1, 4], "msgsize": 2, "multi": [1, 10], "multipl": [3, 5, 10], "multiprocess": 1, "must": [1, 3, 4, 5], "my": 4, "my_kernel": 5, "my_kernel_profiler_init_context": 5, "my_p": 4, "my_rank": 4, "mykernelarg": 5, "mykernellaunch": 5, "mykernelslot": 5, "n": 4, "name": [1, 4, 5, 7, 9], "namespac": 5, "nativ": 8, "nbyte": 4, "nccl": [1, 4, 10], "necessari": [3, 5], "need": [3, 4, 5], "network": [0, 1, 3], "new": [4, 5], "next": [5, 8], "nic": [1, 2, 4, 8], "nnode": [0, 1, 2], "node": [2, 4, 8, 10], "node_rank": [0, 1, 2], "non": 4, "none": 1, "note": [1, 5], "notif": 3, "now": 5, "npe": 4, "nproc": 1, "nproc_per_nod": [0, 1, 2], "num": 2, "num_ev": 3, "num_experts_per_rank": 1, "num_experts_per_token": 1, "num_qp": 4, "num_qp_per_p": 1, "num_rank": 4, "num_stream": 3, "num_token": 1, "num_worker_thread": 3, "numactl": 2, "number": [0, 1, 2, 3, 4], "o": [1, 8, 10], "object": [3, 5], "occur": 3, "off": [1, 5], "offset": [4, 5], "offset_buff": 5, "onc": [3, 4], "one": [3, 4, 5], "onli": [0, 1, 4, 5], "op": [0, 1, 2, 5, 6, 10], "open": 5, "openshmem": 4, "oper": [2, 3, 4, 5, 7, 8, 10], "opt": 9, "optim": [1, 8], "option": [0, 5], "origin": 1, "other": [3, 4], "out": 5, "output": [0, 1, 6, 7, 10], "output_tensor": [6, 10], "over": 3, "overhead": [3, 5], "overlap": [1, 5], "overrid": [1, 5], "overview": 8, "own": 3, "p2p": [1, 3], "packed_recv_count": 1, "packed_recv_layout_rang": 1, "packed_recv_src_info": 1, "packed_recv_x": 1, "page": 8, "pair": [1, 2, 3, 4], "parallel": [1, 6], "paramet": [1, 5, 6], "pars": 5, "parti": 3, "particip": [3, 4], "pass": [1, 3, 5], "path": [0, 1, 2, 3, 7, 9], "pattern": 5, "pe": 1, "penalti": 3, "pensando": 1, "per": [1, 2, 3, 4, 5, 10], "perfetto": [1, 5], "perform": [0, 3, 5, 7, 8], "perspect": 3, "phase": [1, 5], "phase1": 5, "phase2": 5, "physcpubind": 2, "pip": [1, 5, 9], "pipelin": 1, "plane": 3, "platform": 8, "point": [1, 3, 6], "pointer": [3, 4], "poll": [2, 3], "poll_cq_mod": [2, 3], "pollcqmod": 3, "pop_inbound_transfer_statu": 3, "port": [1, 3], "posit": 1, "post_batch_s": 3, "power": 4, "practic": 8, "pre": [1, 3, 4], "prefix": 0, "prepar": 1, "preprocessor": 5, "previou": 5, "primari": 3, "primit": 8, "print": [1, 9, 10], "printf": 1, "prioriti": 1, "process": 6, "produc": 5, "product": [5, 6], "profil": 8, "profilerconfig": 5, "progress": 3, "project": 5, "protocol": 3, "provid": [1, 3, 4, 6], "ptr": [3, 4], "public": [1, 3, 4], "py": [0, 1, 2, 3, 4, 5, 9], "pybind": [1, 3, 4], "python": [0, 1, 2, 4, 7, 8, 9], "python3": [0, 1, 9], "pythonpath": [0, 2], "pytorch": [3, 9], "qp": [2, 3], "qp_per_transf": 3, "quantiz": 1, "queri": [3, 5], "queue": [1, 2, 3, 4], "quickstart": 8, "r": 9, "r_offset": 3, "raii": 5, "rais": 1, "rand": 1, "randint": 3, "randn": [1, 6, 10], "random": 1, "randperm": 1, "rang": [1, 10], "rank": [0, 1, 2, 4, 5, 6, 10], "rate": 5, "raw": 3, "rdma": [0, 1, 3, 4, 8, 10], "rdma_block_num": 1, "rdma_config": 3, "rdmabackendconfig": 3, "reach": 4, "read": 8, "readi": 3, "rebuild": [1, 5], "receiv": [0, 1, 6], "recommend": 5, "reconstruct": 1, "record": 5, "recurs": 9, "recv": 8, "recv_count": 1, "recv_num_token": 1, "recv_token": 1, "reduc": [3, 8, 10], "reduce_scatt": 6, "reduceop": [6, 10], "reduct": 6, "region": [3, 4, 5], "regist": [1, 3, 5], "register_memori": 3, "register_remote_engin": 3, "register_torch_tensor": 3, "registr": 3, "reli": 5, "remot": [3, 4], "remote_mem": 3, "remote_ptr": 4, "remov": [3, 5], "remove_backend": 3, "repeat": 3, "repetit": 3, "replac": [0, 1, 2], "report": 1, "repositori": 9, "repres": 3, "requir": [1, 8, 10], "reserv": 4, "resourc": 3, "respons": 3, "result": [1, 3, 8, 10], "return": [1, 3, 4], "reusabl": 3, "roce": 0, "rocm": [1, 8, 9], "rocm_path": 9, "rocminfo": 9, "rout": 1, "row": 5, "run": [0, 1, 2, 5], "run_ep": 1, "runtim": 4, "runtimeerror": [1, 9], "same": [1, 2, 4], "save": [8, 10], "save_result": [7, 10], "scale": 1, "scale_dim": 1, "scale_type_s": 1, "scan": 5, "scatter": 8, "scope": 5, "script": 5, "search": 8, "section": [3, 4], "see": [1, 3, 5, 10], "select": [1, 4, 5, 8], "send": 8, "sent": 1, "separ": 1, "seq": 5, "sequenti": 5, "seri": 9, "server": 3, "sess": [2, 3], "session": [2, 3], "set": [0, 1, 2, 3, 4, 5, 7], "set_devic": 1, "set_log_level": [3, 7], "set_output_dir": 7, "setup": [1, 3, 5, 9, 10], "sever": 1, "sglang": 1, "shape": 10, "share": [4, 5], "shmem": 1, "shmem_barrier_al": 4, "shmem_buffer_deregist": 4, "shmem_buffer_regist": 4, "shmem_ext_malloc_with_flag": 4, "shmem_fin": [1, 4], "shmem_fre": 4, "shmem_get_unique_id": [1, 4], "shmem_init_attr": [1, 4], "shmem_malloc": 4, "shmem_malloc_align": 4, "shmem_module_init": 4, "shmem_myp": 4, "shmem_np": 4, "shmem_num_qp_per_p": 4, "shmem_ptr_p2p": 4, "shmem_torch_process_group_init": [1, 4], "should": 0, "show": [3, 5], "side": [1, 3], "simpl": 4, "simplest": 5, "simpli": 5, "simul": 1, "singl": [1, 2, 5], "size": [1, 3, 4, 7, 8], "size_byt": 7, "size_in_byt": 4, "slot": 5, "slow": 3, "small": [1, 5, 10], "smi": 9, "so": 5, "socket": 0, "sourc": [5, 6, 8], "span": 5, "spawn": 1, "specif": [0, 1, 3, 5], "specifi": [0, 1], "src": [1, 3, 4, 5, 6], "src_rank": 1, "src_tensor": 3, "src_token_id": 1, "src_token_po": 1, "stack": 1, "stage": 5, "standard": [4, 7], "start": [2, 10], "state": [1, 3, 4, 5], "statu": [3, 4, 8], "statuscod": 3, "step": 8, "still": [3, 5], "stop": [7, 10], "store": [3, 5], "str": 3, "string": 5, "struct": 5, "style": 4, "succeed": 3, "success": [3, 4], "successfulli": 3, "suit": 3, "sum": [6, 10], "sunway513": 8, "support": [1, 3, 5, 9], "symbol": 4, "symmetr": 1, "synchron": [1, 5, 6], "system": 5, "t": 5, "taken": 1, "target": [2, 3], "target_desc": 3, "target_mem": 3, "tcp": [0, 1, 3, 4], "templat": 5, "tensor": [1, 3, 4, 6, 7, 10], "test": [0, 1, 2, 3], "test_dispatch_combin": 1, "test_dispatch_combine_internod": [0, 1], "test_engin": 3, "them": [1, 3], "thi": [1, 3, 4, 5, 6, 10], "thor2": [1, 8], "thread": [1, 2], "threadidx": 5, "through": [1, 5], "throughput": 1, "time": 1, "timelin": 5, "timestamp": 7, "tip": 8, "togeth": 3, "token": [0, 1], "too": 5, "tool": [5, 7, 8, 10], "top": 1, "topologi": 1, "torch": [1, 3, 4, 6, 10], "torchrun": [0, 1, 2], "total": [0, 1, 4], "total_p": 4, "total_recv": 1, "totals": 2, "trace": [1, 7], "trace_buff": [1, 5], "train": [6, 8], "transfer": [1, 2, 3], "transferstatu": 3, "transport": [1, 3, 4], "troubleshoot": 8, "true": [1, 3], "try": 5, "tune": 1, "tupl": 1, "two": [1, 2, 3, 4], "txt": 9, "type": [2, 3], "typenam": 5, "typic": [1, 3, 5], "u": 2, "ui": [1, 5], "uid": 3, "uint8": 3, "underscor": 5, "understand": 10, "uniqu": [3, 5], "unique_id": [1, 4], "unknown": 3, "unless": 1, "until": [3, 4], "up": 5, "upon": 4, "uppercase_filenam": 5, "us": [0, 1, 2, 3, 4, 5, 7, 10], "usag": [3, 5, 6], "use_bnxt": 1, "use_external_inp_buf": 1, "use_ion": 1, "use_rocm": 1, "util": 3, "v": [1, 5], "v0": 1, "v1": 1, "v1ll": 1, "valu": [1, 3, 4, 5], "variabl": [0, 5, 8], "variant": 1, "verbos": 3, "veri": 6, "verif": [1, 8], "verifi": 9, "version": 9, "via": [1, 4], "view": 7, "virtual": 4, "visibl": 5, "visual": [1, 8, 10], "viz": [8, 10], "vllm": 1, "void": 5, "wa": 1, "wait": 3, "wall_clock64": 5, "want": 0, "warp": [1, 5], "warp_num_per_block": 1, "warp_per_block": 1, "warpsiz": 5, "weight": 1, "what": [1, 4], "when": [1, 2, 4, 5], "where": [3, 5], "whether": 5, "which": [0, 4, 5], "while": 3, "why": 5, "within": [1, 5], "without": [3, 4, 5], "work": 5, "worker": 2, "workflow": 8, "world": [1, 4], "world_group": [1, 4], "world_siz": [1, 4, 10], "would": 5, "wrap": [1, 5], "wraparound": 5, "wrapper": 5, "write": [5, 8], "written": 5, "x": 5, "xgmi": [0, 1, 3, 4], "xgmibackendconfig": 3, "ye": 1, "you": [0, 5, 10], "your": [2, 4, 5, 7, 9, 10], "zero": [1, 3, 4, 5], "zero_": 5, "zeros_lik": 10}, "titles": ["MORI-EP Benchmark", "MORI-EP User Guide", "MORI-IO Benchmark", "MORI-IO Introduction", "MORI Shmem Guide", "MORI-VIZ (Visualizer)", "Communication Operations", "Profiler", "MORI Documentation", "Installation", "Quickstart"], "titleterms": {"1": [1, 2, 4, 5], "10": 1, "11": 1, "2": [1, 4, 5], "3": [1, 4, 5], "4": [1, 4], "5": [1, 4], "6": [1, 4], "7": [1, 4], "8": [1, 4], "9": 1, "No": 1, "add": 5, "address": 4, "advanc": 7, "all": [6, 10], "alloc": 4, "analysi": 5, "analyz": 7, "api": [1, 3, 4, 8], "architectur": 3, "argument": 2, "auto": 1, "barrier": 6, "basic": [3, 10], "batch": 2, "benchmark": [0, 1, 2], "best": 5, "broadcast": 6, "buffer": 4, "build": [1, 5], "characterist": 6, "code": 5, "combin": 1, "combine_standard_mo": 1, "command": 2, "commun": [6, 10], "compat": 1, "complet": 1, "concept": [3, 4], "config": 1, "configur": [1, 3], "content": [0, 1, 2, 3, 4, 5], "context": [5, 7], "convert_combine_input": 1, "convert_dispatch_output": 1, "cx7": 2, "deepep": 1, "deepseek": 1, "default": 1, "defin": 5, "design": 3, "devic": 5, "dispatch": 1, "dispatch_standard_mo": 1, "distribut": 1, "document": 8, "elaps": 5, "element": 4, "enabl": 5, "environ": [1, 3, 4, 9], "ep": [0, 1], "epdispatchcombineconfig": 1, "epdispatchcombineop": 1, "exampl": [1, 3, 10], "exist": 4, "featur": [7, 8], "file": [1, 3, 4], "final": 4, "flag": 4, "framework": 1, "free": 4, "from": 9, "gather": [6, 10], "gener": 5, "get": 8, "get_dispatch_src_token_po": 1, "get_registered_combine_input_buff": 1, "gpu": 8, "group": [1, 4], "guid": [1, 4], "header": 5, "heap": 4, "help": 8, "hip": 4, "id": [1, 4], "includ": 5, "indic": 8, "init": 4, "initi": [1, 4], "instal": 9, "instrument": 5, "integr": [1, 4], "inter": [0, 1], "intra": [0, 1], "introduct": 3, "io": [2, 3], "kernel": 1, "launch": 1, "link": 8, "manag": [4, 7], "manual": 1, "measur": 5, "memori": 4, "messag": 2, "method": [1, 4, 9], "mode": 1, "modul": 4, "moe": 1, "mori": [0, 1, 2, 3, 4, 5, 8], "next": 10, "nic": 0, "node": [0, 1], "oper": [1, 6], "option": 1, "overview": 5, "p2p": 4, "pe": 4, "perform": [1, 6, 10], "point": 5, "practic": 5, "process": [1, 4], "profil": [1, 5, 7, 10], "python": [3, 5], "pytorch": [1, 4], "queri": 4, "quick": [1, 3, 4, 8], "quickstart": 10, "rdma": 2, "read": [2, 3], "recommend": [1, 4], "recv": [1, 6], "reduc": 6, "refer": [1, 3, 4, 8], "regist": 4, "requir": 9, "reset": 1, "result": [2, 7], "save": 7, "scatter": 6, "select": 0, "send": [1, 6], "shmem": 4, "side": 5, "size": 2, "sourc": [1, 3, 4, 9], "split": 1, "standalon": 4, "standard": 1, "start": [7, 8], "step": 10, "support": 8, "sweep": 2, "symmetr": 4, "synchron": 4, "tabl": [0, 1, 2, 3, 4, 5, 8], "thor2": 2, "time": 5, "tip": 10, "trace": 5, "translat": 4, "triton": 4, "troubleshoot": 9, "type": 1, "uniqu": [1, 4], "user": 1, "v3": 1, "variabl": [1, 4, 9], "verif": 9, "view": 5, "visual": [5, 7], "viz": [1, 5], "workflow": 3, "write": [2, 3]}})