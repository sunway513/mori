Search.setIndex({"alltitles": {"1. Concepts": [[5, "concepts"]], "1. Include Headers": [[6, "include-headers"]], "1. Installation (docs/installation.rst)": [[0, "installation-docs-installation-rst"]], "1. Kernel Types": [[2, "kernel-types"]], "10. Profiling with MORI-VIZ": [[2, "profiling-with-mori-viz"]], "11. Framework Integration": [[2, "framework-integration"]], "2. API Documentation - Collective Communication (docs/api/communication.rst)": [[0, "api-documentation-collective-communication-docs-api-communication-rst"]], "2. Configuration": [[2, "configuration"]], "2. Define Profiler Context": [[6, "define-profiler-context"]], "2. Initialization": [[5, "initialization"]], "3. API Documentation - Profiler (docs/api/profiler.rst)": [[0, "api-documentation-profiler-docs-api-profiler-rst"]], "3. Add Trace Points": [[6, "add-trace-points"]], "3. Operator API": [[2, "operator-api"]], "3. Query APIs": [[5, "query-apis"]], "4. Memory Management": [[5, "memory-management"]], "4. Quickstart (docs/quickstart.rst)": [[0, "quickstart-docs-quickstart-rst"]], "4. Standard MoE Compatibility (DeepEP)": [[2, "standard-moe-compatibility-deepep"]], "5. Index (docs/index.rst)": [[0, "index-docs-index-rst"]], "5. Initialization": [[2, "initialization"]], "5. P2P Address Translation": [[5, "p2p-address-translation"]], "6. Launch Configuration": [[2, "launch-configuration"]], "6. Synchronization": [[5, "synchronization"]], "7. Complete Example": [[2, "complete-example"]], "7. HIP Module Init (Triton Integration)": [[5, "hip-module-init-triton-integration"]], "8. Environment Variables": [[2, "environment-variables"]], "8. Initialization Flags": [[5, "initialization-flags"]], "9. Benchmarking": [[2, "benchmarking"]], "API Reference": [[9, null]], "Advanced Features": [[8, "advanced-features"]], "All-Gather": [[7, "all-gather"]], "All-Gather Example": [[11, "all-gather-example"]], "All-Reduce": [[7, "all-reduce"]], "Allocating Symmetric Memory": [[5, "allocating-symmetric-memory"]], "Analyzing Results": [[8, "analyzing-results"]], "Architecture": [[4, "architecture"]], "Auto Mode": [[2, "auto-mode"]], "Barrier": [[7, "barrier"]], "Basic Communication Example": [[11, "basic-communication-example"]], "Batch Size Sweep": [[3, "batch-size-sweep"]], "Benchmark Arguments": [[3, "benchmark-arguments"]], "Benchmark Commands": [[3, "benchmark-commands"]], "Best Practices": [[6, "best-practices"]], "Broadcast": [[7, "broadcast"]], "Build & Code Generation": [[6, "build-code-generation"]], "Build Options": [[2, "build-options"]], "Code Generation": [[6, "code-generation"]], "Communication Operations": [[7, null]], "Context Manager": [[8, "context-manager"]], "Critical Issues": [[0, "critical-issues"]], "Design & Concepts": [[4, "design-concepts"]], "Device-side Elapsed Time Measurement": [[6, "device-side-elapsed-time-measurement"]], "Enabling the Profiler": [[6, "enabling-the-profiler"]], "Environment & Configuration": [[4, "environment-configuration"]], "Environment Variables": [[5, "environment-variables"], [10, "environment-variables"]], "EpDispatchCombineConfig": [[2, "epdispatchcombineconfig"]], "EpDispatchCombineOp": [[2, "epdispatchcombineop"]], "Example: Basic Read/Write": [[4, "example-basic-read-write"]], "Executive Summary": [[0, "executive-summary"]], "Features": [[9, null], [9, "features"]], "Files Reviewed": [[0, "files-reviewed"]], "Finalization": [[5, "finalization"]], "Freeing Symmetric Memory": [[5, "freeing-symmetric-memory"]], "From Source": [[10, "from-source"]], "Getting Help": [[9, "getting-help"]], "Getting Started": [[9, null]], "High Priority (P1) - Requires Complete Rewrite": [[0, "high-priority-p1-requires-complete-rewrite"]], "Immediate (P0)": [[0, "immediate-p0"]], "Indices and tables": [[9, "indices-and-tables"]], "Installation": [[10, null]], "Installation Methods": [[10, "installation-methods"]], "Instrumentation": [[6, "instrumentation"]], "Inter-node": [[1, "inter-node"], [2, "inter-node"]], "Intra-node": [[1, "intra-node"], [2, "intra-node"]], "Issue 1.1: Python Version Mismatch [FIXED \u2713]": [[0, "issue-1-1-python-version-mismatch-fixed"]], "Issue 1.2: Non-existent requirements.txt [FIXED \u2713]": [[0, "issue-1-2-non-existent-requirements-txt-fixed"]], "Issue 1.3: Non-functional Verification Code [FIXED \u2713]": [[0, "issue-1-3-non-functional-verification-code-fixed"]], "Issue 2.1: ENTIRE API DOES NOT EXIST [CRITICAL - NOT FIXED]": [[0, "issue-2-1-entire-api-does-not-exist-critical-not-fixed"]], "Issue 3.1: Profiler API Completely Wrong [CRITICAL - NOT FIXED]": [[0, "issue-3-1-profiler-api-completely-wrong-critical-not-fixed"]], "Issue 4.1: All Examples Use Non-existent API [NOT FIXED]": [[0, "issue-4-1-all-examples-use-non-existent-api-not-fixed"]], "Issue 5.1: Misleading Feature Description [NOT FIXED]": [[0, "issue-5-1-misleading-feature-description-not-fixed"]], "Low Priority (P3)": [[0, "low-priority-p3"]], "MORI Documentation": [[9, null]], "MORI Documentation Accuracy Audit Report": [[0, null]], "MORI Shmem Guide": [[5, null]], "MORI-EP Benchmark": [[1, null]], "MORI-EP User Guide": [[2, null]], "MORI-IO Benchmark": [[3, null]], "MORI-IO Introduction": [[4, null]], "MORI-VIZ (Visualizer)": [[6, null]], "Manual Mode (Default)": [[2, "manual-mode-default"]], "Medium Priority (P2)": [[0, "medium-priority-p2"]], "Message Size Sweep": [[3, "message-size-sweep"]], "Method 1: PyTorch Process Group (Recommended)": [[2, "method-1-pytorch-process-group-recommended"], [5, "method-1-pytorch-process-group-recommended"]], "Method 2: Unique ID (No PyTorch Distributed)": [[2, "method-2-unique-id-no-pytorch-distributed"]], "Method 2: Unique ID (Standalone)": [[5, "method-2-unique-id-standalone"]], "NIC Selection": [[1, "nic-selection"]], "Next Steps": [[11, "next-steps"]], "Overview": [[6, "overview"]], "Performance Characteristics": [[7, "performance-characteristics"]], "Performance Tips": [[11, "performance-tips"]], "Processing Element (PE)": [[5, "processing-element-pe"]], "Profiler": [[8, null]], "Profiling Example": [[11, "profiling-example"]], "Python API Quick Reference": [[4, "python-api-quick-reference"]], "Python Analysis": [[6, "python-analysis"]], "Quick Links": [[9, "quick-links"]], "Quick Reference": [[2, "quick-reference"], [5, "quick-reference"]], "Quickstart": [[11, null]], "Read": [[3, "read"]], "Recommendations": [[0, "recommendations"]], "Reduce-Scatter": [[7, "reduce-scatter"]], "Reference Documentation": [[0, "reference-documentation"]], "Reference Performance (DeepSeek V3 config)": [[2, "reference-performance-deepseek-v3-config"]], "Registering Existing Buffers": [[5, "registering-existing-buffers"]], "Requirements": [[10, "requirements"]], "Results: CX7 RDMA (Batch Size = 1)": [[3, "results-cx7-rdma-batch-size-1"]], "Results: Thor2 RDMA Read": [[3, "results-thor2-rdma-read"]], "Results: Thor2 RDMA Write": [[3, "results-thor2-rdma-write"]], "Saving Results": [[8, "saving-results"]], "Send/Recv": [[7, "send-recv"]], "Source Files": [[2, "source-files"], [4, "source-files"], [5, "source-files"]], "Split dispatch/combine (send + recv)": [[2, "split-dispatch-combine-send-recv"]], "Starting the Profiler": [[8, "starting-the-profiler"]], "Statistics": [[0, "statistics"]], "Supported GPUs": [[9, "supported-gpus"]], "Symmetric Heap": [[5, "symmetric-heap"]], "Symmetric Memory": [[5, "symmetric-memory"]], "Table of Contents": [[1, "table-of-contents"], [2, "table-of-contents"], [3, "table-of-contents"], [4, "table-of-contents"], [5, "table-of-contents"], [6, "table-of-contents"]], "Troubleshooting": [[10, "troubleshooting"]], "Verification": [[10, "verification"]], "Viewing the Trace": [[6, "viewing-the-trace"]], "Visualization": [[8, "visualization"]], "What MORI Actually Does": [[0, "what-mori-actually-does"]], "Workflow": [[4, "workflow"]], "Write": [[3, "write"]], "combine()": [[2, "combine"]], "combine_standard_moe()": [[2, "combine-standard-moe"]], "convert_combine_input()": [[2, "convert-combine-input"]], "convert_dispatch_output()": [[2, "convert-dispatch-output"]], "dispatch()": [[2, "dispatch"]], "dispatch_standard_moe()": [[2, "dispatch-standard-moe"]], "get_dispatch_src_token_pos()": [[2, "get-dispatch-src-token-pos"]], "get_registered_combine_input_buffer()": [[2, "get-registered-combine-input-buffer"]], "reset()": [[2, "reset"]]}, "docnames": ["DOCUMENTATION_AUDIT_REPORT", "MORI-EP-BENCHMARK", "MORI-EP-GUIDE", "MORI-IO-BENCHMARK", "MORI-IO-INTRO", "MORI-SHMEM-GUIDE", "PROFILER", "api/communication", "api/profiler", "index", "installation", "quickstart"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1}, "filenames": ["DOCUMENTATION_AUDIT_REPORT.md", "MORI-EP-BENCHMARK.md", "MORI-EP-GUIDE.md", "MORI-IO-BENCHMARK.md", "MORI-IO-INTRO.md", "MORI-SHMEM-GUIDE.md", "PROFILER.md", "api/communication.rst", "api/profiler.rst", "index.rst", "installation.rst", "quickstart.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [0, 2, 3, 4, 6, 8, 9], "0": [0, 1, 2, 3, 4, 5, 6, 7, 10, 11], "00": 3, "01": 3, "02": [0, 3], "03": 3, "04": 3, "05": 3, "06": 3, "07": 3, "08": 3, "09": 3, "1": [4, 7, 9, 10], "10": [0, 1, 3, 10], "1024": [3, 4, 5, 7, 11], "1024b": 3, "103": [2, 3], "1048576": 3, "108": 3, "11": 3, "113": 3, "114": 3, "116": 3, "117": 3, "1173": 3, "118": 3, "119": 3, "12": 3, "120": 3, "121": 3, "1234": [1, 2, 3], "1234567890": 8, "12355": 2, "1241": 3, "125": 8, "126": 3, "127": 4, "128": [2, 3, 5, 9], "129": [1, 2, 3], "13": 3, "130": 3, "131072": 3, "132": 3, "134": 3, "1359": 3, "1360": 3, "1399": 3, "14": [0, 3], "1403": 3, "143": 3, "1469": 3, "147": 3, "1488": 3, "1497": 3, "1498": 3, "15": [0, 3], "152": 3, "16": [2, 3], "161": 2, "16384": [3, 6], "16777216": 3, "17": 3, "172": 0, "174": 3, "175": 3, "18": 3, "181": 3, "189": 3, "19": 3, "192": [3, 9], "193": 3, "194": [1, 2, 3], "1kb": 3, "1mb": 3, "2": [1, 3, 9], "20": 3, "200": 3, "202": 3, "2026": 0, "2048": 3, "208": 2, "2097152": 3, "21": 3, "22": 3, "23": 3, "2301": 3, "235": 3, "2390": 3, "24": 3, "25": 3, "256": [2, 3, 4, 5, 11], "26": 3, "262144": 3, "268": 3, "27": 3, "275": 3, "2770": 3, "2777": 3, "28": 3, "281": 3, "2856": 3, "2867": 3, "29": 3, "2d": 2, "2g": [2, 5], "3": [3, 4, 8, 9, 10], "30": 3, "307": 2, "31": [3, 8], "32": [2, 3], "324": 3, "32768": 3, "33": 3, "330": 2, "33554432": 3, "336": 3, "34": 3, "344": 3, "35": 3, "36": 3, "37": 3, "371": 3, "374": 3, "379": 3, "38": 3, "39": 3, "3d": 2, "3rd": 4, "4": [3, 6, 10], "40": 3, "4096": [2, 3, 6], "41": 3, "4194304": [3, 8], "42": 3, "43": 3, "44": 3, "447": 3, "45": 3, "458": 3, "4585": 3, "46": 3, "4617": 3, "47": 3, "48": 3, "49": [2, 3], "5": [3, 4, 11], "50": [2, 3], "51": 3, "512": [3, 11], "512m": 5, "52": 3, "524288": 3, "53": 3, "54": 3, "55": 3, "56": 3, "5605": 3, "5622": 3, "57": [2, 3], "58": 3, "59": 3, "599": 3, "6": [3, 10], "60": 3, "61": 3, "611": 3, "62": 3, "63": [2, 3], "64": [2, 3, 4], "64mb": 3, "65": [1, 2, 3], "65536": 3, "66": 3, "67": 3, "67108864": 3, "68": 3, "682": 3, "683": 3, "69": 3, "6g": [2, 5], "7": 3, "70": 3, "71": 3, "715": 3, "7168": [2, 5], "717": 3, "72": 3, "73": 3, "74": 3, "75": 3, "752": 3, "76": 3, "77": 3, "78": 3, "781": 3, "79": 3, "8": [0, 1, 3, 8, 11], "80": 2, "805": 3, "8080": 4, "8081": 4, "81": 3, "8192": 3, "82": 3, "83": 3, "8388608": 3, "84": 3, "85": 3, "86": 3, "87": 3, "88": 3, "89": 3, "8b": 3, "9": 3, "90": 3, "91": [2, 3], "92": 3, "93": 3, "94": 3, "95": 3, "96": [2, 3], "97": 3, "98": 3, "99": 3, "A": [4, 5, 6, 10], "By": 6, "For": [0, 1, 2, 5, 6, 7, 11], "If": [1, 2, 6], "In": 6, "It": [2, 4, 5, 6], "Its": [4, 5], "NO": 0, "No": [0, 10], "ON": [2, 6], "One": 4, "The": [0, 1, 2, 4, 5, 6], "Then": 5, "There": [2, 5], "These": [2, 4, 6], "To": [1, 2, 6], "With": 4, "_": [2, 11], "__global__": 6, "__init__": [2, 4, 5], "__main__": 2, "__name__": 2, "__version__": [0, 10], "_c": [2, 5], "_distributed_c10d": [2, 5], "_handl": [2, 6], "_profiler_init_context": 6, "_register_process_group": [2, 5], "about": [0, 11], "abstract": 4, "access": [4, 5, 10], "accur": 0, "achiev": 4, "across": [2, 5, 7], "activ": [2, 4], "actual": 1, "ad": 0, "add": 0, "address": 2, "advanc": 9, "after": [2, 4, 6], "ai": 9, "aiter": 2, "align": 5, "all": [1, 2, 3, 5, 6, 9], "all_gath": [0, 7, 8, 11], "all_profiler_slot": 6, "all_reduc": [0, 7, 8, 11], "alloc": [0, 4], "allocate_transfer_uid": 4, "allow": 6, "alreadi": 5, "also": 6, "alwai": 5, "amd": [2, 4, 9, 10], "among": 4, "an": 5, "analysi": [0, 9], "analyz": 9, "ani": [2, 4, 5], "anoth": 6, "api": 6, "applic": [4, 5], "ar": [2, 4, 5, 6, 10], "architectur": [0, 9, 10, 11], "arg": [2, 6], "argument": [2, 6, 9], "arithmet": 5, "art": 2, "assert": 4, "assign": 2, "async": 2, "asynchron": 4, "asyncl": 2, "atom": 2, "auditor": 0, "auto": [4, 6], "autom": 0, "automat": [2, 6, 8], "avail": [1, 2, 5, 6, 10], "avg": 3, "avoid": 6, "b": [3, 6], "back": 2, "backend": [2, 4, 5, 11], "backendtyp": 4, "bandwidth": [1, 2, 4, 7, 8, 11], "bandwidth_gbp": 8, "barrier": [0, 5, 8, 9, 11], "base": [0, 2], "baselin": 2, "basic": [5, 9], "batch": [2, 4, 9, 11], "batch_read": 4, "batch_writ": 4, "batchsiz": 3, "befor": [2, 4, 5, 6], "begin": 6, "below": 4, "bench": [1, 2], "bench_dispatch_combin": [1, 2], "benchmark": [4, 9, 11], "best": [7, 9], "between": [0, 2, 4, 6], "bf16": [2, 11], "bfloat16": [2, 5], "bind": [2, 4, 5, 6], "block": [2, 4, 5], "block_num": 2, "blockdim": 6, "blockidx": 6, "bool": 2, "both": [2, 4, 5], "bottleneck": 11, "broadcast": [0, 2, 5, 9], "broadcom": 2, "buffer": [2, 3, 4, 6], "build": [0, 5, 9, 10], "build_io": 2, "build_op": 2, "build_pybind": 2, "build_shmem": 2, "built": [4, 8, 9], "bulk": 4, "busi": 4, "bw": [1, 2, 3], "byte": [2, 3, 5, 8], "c": [2, 4, 5, 6], "calcul": [1, 2, 6], "call": [2, 6], "call_reset": 2, "camelcas": 6, "camelcasefilenam": 6, "can": [1, 2, 4, 6, 8], "captur": 2, "case": [2, 4], "caus": 6, "cd": [0, 1, 2, 3, 10], "cdna": 9, "central": 4, "characterist": 9, "check": [0, 4, 10], "checkpoint": 6, "choos": 2, "chrome": [0, 6, 8], "ci": 0, "circular": 6, "claim": 0, "clarifi": 0, "class": 4, "claud": 0, "clean": 6, "cleanup": [2, 5], "clear": 6, "click": 6, "clone": [2, 10], "cmake": [2, 6], "code": [4, 5, 8, 9], "codebas": 0, "collect": [2, 7], "com": [9, 10], "combin": [0, 1, 6, 11], "combine_buf": 2, "combine_out": 2, "combine_output": 2, "combine_recv": 2, "combine_send": 2, "combine_w": 2, "combine_weight": 2, "command": [1, 4, 9], "commun": [2, 4, 5, 8, 9], "compil": [5, 6, 10], "complet": 4, "compon": [4, 5], "comprehens": 4, "comput": [2, 6], "concept": 9, "condit": 6, "config": [3, 4, 6], "configur": [0, 6, 9], "connect": [4, 5], "consecut": 3, "consid": 6, "content": 9, "context": [4, 9], "control": [4, 5, 6], "convent": 6, "convers": [0, 2, 6], "convert": [2, 6, 8], "copi": [2, 4, 5, 6], "copy_": 2, "core": [2, 4, 6], "correct": 2, "correspond": [2, 4], "count": 2, "cpp": [2, 4, 5, 6], "cpu": [2, 4, 5], "cpunodebind": 3, "cq": [3, 4], "creat": [2, 4, 6, 11], "create_backend": 4, "create_sess": 4, "critic": 4, "csv": [0, 8], "cu": 2, "cuda": [2, 4, 5, 7, 10, 11], "current": [2, 4, 5], "custom": 4, "cx7": 9, "data": [2, 4, 6, 7, 8], "data_ptr": 5, "data_typ": 2, "dataclass": 2, "date": 0, "debug": [2, 6, 8], "dedic": 2, "def": 2, "default": [1, 4, 5, 6], "del": 2, "deleg": 2, "deliv": 2, "denable_profil": 6, "deregist": [4, 5], "deregister_memori": 4, "deregister_remote_engin": 4, "deriv": 6, "desc": 4, "describ": 0, "descript": [2, 3, 4, 5], "descriptor": 4, "design": [6, 9], "dest_p": 5, "destroi": 5, "destroy_process_group": [2, 5], "detail": [4, 6, 8], "detect": 6, "dev": [2, 3, 6], "develop": [6, 10], "devic": [1, 2, 3, 4, 5, 7, 11], "device_id": [2, 4], "diagram": 0, "differ": [0, 2, 5], "dim": 2, "dimens": 2, "direct": 4, "directli": [4, 5, 6], "directori": [0, 6, 8], "disabl": 6, "discov": 6, "discuss": 9, "dispatch": [0, 6], "dispatch_": 2, "dispatch_combin": [1, 2], "dispatch_idx": 2, "dispatch_indic": 2, "dispatch_out": 2, "dispatch_out_topk_idx": 2, "dispatch_out_x": 2, "dispatch_output": 2, "dispatch_recv": 2, "dispatch_scal": 2, "dispatch_send": 2, "dispatch_w": 2, "dispatch_weight": 2, "dist": [2, 5], "distribut": [0, 5, 7, 9], "diverg": 6, "do": 6, "doc": [4, 9], "docstr": 0, "document": 2, "domain": 5, "don": 0, "done": 5, "driven": 4, "dsc": 2, "dst": 7, "dst_tensor": 4, "dtype": [2, 4, 5, 11], "durat": 8, "duration_u": 8, "dure": 4, "dynam": 5, "e": [2, 3, 4, 5, 6], "each": [1, 2, 4, 5, 6], "effici": [0, 4, 9], "element": 2, "element_s": 2, "elimin": 4, "els": 10, "embed": 2, "empti": 2, "enabl": [2, 3, 4, 5, 8, 10, 11], "enable_debug_printf": 2, "enable_notif": 4, "enable_profil": [2, 6], "enable_standard_moe_adapt": 2, "end": 6, "engin": [0, 4], "enginedesc": 4, "ens14np0": [1, 2, 3], "ensur": [4, 6, 10], "entir": 6, "entri": 6, "enum": [0, 4, 6], "environ": [1, 9], "ep": [0, 5, 9], "ep16": 2, "ep32": 2, "ep8": 2, "ep_trac": 2, "epdispatchcombineconfig": 0, "epdispatchcombinekerneltyp": 2, "epdispatchcombineop": [0, 6], "err_bad_st": 4, "err_gpu_op": 4, "err_invalid_arg": 4, "err_not_found": 4, "err_rdma_op": 4, "error": [0, 6], "establish": 4, "etc": [2, 4, 5], "evalu": 6, "event": [3, 4, 6], "everi": 5, "exactli": 5, "exampl": [1, 6, 7, 8, 9], "exchang": 4, "exclud": [1, 2, 5], "execut": 6, "exist": 6, "exit": 5, "expans": 6, "expect": 4, "experiment": 9, "expert": [0, 2], "expert_output": 2, "explicit": 6, "export": [0, 1, 2, 3, 4, 5, 6, 10], "export_to_perfetto": [0, 2, 6], "extens": 6, "extern": 2, "extract": 6, "f": [2, 10, 11], "factual": 0, "fail": [0, 4], "failov": 4, "failur": 4, "fals": 2, "fast": 4, "featur": [6, 10], "field": 2, "file": [6, 9], "filenam": 6, "filter": [0, 8], "find": 6, "first": [4, 6, 10, 11], "five": 2, "float16": 11, "float32": 2, "float8_e4m3fnuz": 2, "follow": [1, 6], "form": 4, "format": [0, 2, 6, 8], "found": [0, 10], "foundat": 5, "fp16": 11, "fp8": 2, "free": 4, "frequenc": 6, "from": [0, 2, 3, 4, 5, 6, 7], "full": 2, "fulli": 9, "function": [4, 5, 6], "fused_mo": 2, "fusedmo": 2, "fusedmoeparallelconfig": 2, "g": [2, 3, 4, 5, 6], "gather": [0, 9], "gb": [2, 3, 8, 9], "gdr": 4, "gener": [0, 2, 5, 9], "generate_profiler_bind": 6, "get": [2, 4, 5, 6, 11], "get_debug_time_buf": [2, 6], "get_debug_time_offset": 6, "get_engine_desc": 4, "get_world_s": [0, 11], "gfx": 10, "gfx90a": [9, 10], "gfx942": [9, 10], "gfx950": 9, "git": 10, "github": [9, 10], "global": [5, 6], "globalgpust": 5, "globalthdid": 6, "globalwarpid": 6, "gloo": [2, 5], "gloo_socket_ifnam": [1, 2, 3], "goe": 6, "gpu": [0, 2, 4, 5, 6, 10], "gpu_arch": 10, "gpu_freq_ghz": 6, "gpu_per_nod": 2, "gradient": 7, "granular": 6, "grep": 10, "group": 4, "guid": [0, 11], "handl": [2, 6], "happen": 4, "hardwar": [5, 6], "hasattr": [2, 6, 10], "have": 6, "hbm2e": 9, "hbm3": 9, "header": [2, 5], "heap": 2, "helper": 6, "here": [6, 8], "hidden": 2, "hidden_dim": 2, "high": [2, 4, 6, 7, 9], "higher": [2, 4], "hip": [2, 10], "hip_module_handl": 5, "hipdeviceattributewallclockr": 6, "hipdevicegetattribut": 6, "host": [2, 3, 4, 6], "how": 2, "hpp": [2, 6], "http": [9, 10], "i": [0, 2, 4, 5, 6, 9, 10, 11], "id": [4, 6], "ident": 2, "identifi": [0, 11], "if_enable_profil": 6, "ignor": 2, "imag": 4, "immedi": 6, "impact": [0, 6], "implement": 2, "import": [2, 4, 5, 6, 7, 8, 10, 11], "importerror": 10, "improv": 4, "in_progress": 4, "inbound": 4, "includ": [1, 2, 4, 5, 8], "increas": 4, "index": 9, "indic": 2, "infer": [2, 4, 9], "info": 3, "infrastructur": 9, "init": [0, 2, 4], "init_process_group": [0, 2, 5, 11], "initi": [0, 3, 4, 6, 11], "initiator_desc": 4, "initiator_mem": 4, "inprogress": 4, "input": [2, 7, 11], "input_data": 2, "input_tensor": [7, 11], "insid": 4, "instal": [2, 6, 9], "instanc": 6, "instant": 6, "instinct": [9, 10], "instruct": [0, 10], "instrument": 9, "int": [2, 4, 5, 6, 7], "int32": 2, "integ": 5, "integr": [0, 6, 9], "intens": 6, "inter": 9, "interact": 4, "interfac": [1, 2, 3, 4], "intern": 2, "internod": 2, "internode_v1": [2, 6], "internodev1": [2, 6], "internodev1l": 2, "internodev1slot": 6, "interrupt": 4, "intra": [5, 9], "intranod": 2, "introduct": [9, 11], "invalid": 5, "involv": 4, "io": [0, 2, 5, 9, 10, 11], "ioengin": [0, 4], "ioengineconfig": [0, 4], "ioenginesess": 4, "ip": 1, "is_avail": [0, 10], "issu": [4, 9], "item": [2, 6], "iter": [2, 6], "its": [1, 4, 5], "join": 2, "json": [0, 2, 6, 8, 11], "k": 2, "keep": 6, "kei": [4, 6], "kernel": [0, 5, 6], "kernel_profil": [0, 2, 6, 10], "kernel_typ": 2, "kernelmain": 6, "kind": 4, "know": 6, "kvcach": [0, 4], "l_offset": 4, "lane": 6, "laneid": 6, "larg": [2, 7], "lat": 3, "latenc": [0, 2, 3, 4, 6, 7], "later": [0, 10], "launch": 4, "layer": [0, 5], "layout": 2, "ld_library_path": 10, "learn": 11, "len": 11, "level": [0, 3, 4, 6], "leverag": 4, "lib": 10, "librari": [0, 2, 4, 9, 10], "lightweight": 4, "like": [0, 2, 6], "limit": 6, "line": 0, "list": [0, 7, 11], "ll": 2, "llm": [0, 2, 4], "load": 10, "local": [4, 5], "local_mem": 4, "local_ptr": 5, "localhost": 2, "log": [3, 4, 6, 8], "long": 6, "loop": 6, "low": [2, 4, 6, 7], "low_latency_async": 2, "lower": [3, 4], "m": 8, "machin": 6, "macro": 6, "mai": 6, "main": [4, 6], "manag": [0, 4, 9], "manual": 6, "map": [2, 5, 6], "master": 2, "master_addr": [1, 2, 3], "master_port": [1, 2, 3], "max": [2, 3, 7], "max_num_inp_token_per_rank": 2, "max_token_type_s": 2, "maximum": [2, 3], "mb": [3, 4], "md": [0, 2, 4], "mean": 5, "medium": [4, 7], "mem_desc": 4, "mem_loc": 4, "member": 6, "membind": 3, "memori": [0, 2, 4, 6, 9], "memorydesc": 4, "memorylocationtyp": 4, "memorywait": 6, "merg": 6, "messag": 4, "metadata": 4, "method": [4, 9], "mi200": 10, "mi250x": 9, "mi300": 10, "mi300a": 9, "mi300x": 9, "microsecond": 8, "min": [3, 7], "minim": [4, 6], "minut": 11, "miss": 0, "mixtur": [0, 2], "mlx5_0": [1, 2, 5], "mlx5_1": [1, 2, 5], "mlx5_2": [1, 2, 5], "mlx5_3": [1, 2, 5], "mode": [3, 4], "model": [2, 7], "model_op": 2, "modul": [0, 6, 10], "moe": 0, "moe_op": 2, "more": 4, "mori": [7, 8, 10, 11], "mori_all2al": 2, "mori_enable_profil": 10, "mori_ep_launch_config_mod": 2, "mori_profil": 11, "mori_rdma_devic": [1, 2, 5], "mori_shmem_heap_s": [2, 5], "mori_shmem_init_with_mpi_comm": 5, "mori_shmem_init_with_uniqueid": [2, 5], "mori_trace_": 6, "mori_trace_inst": 6, "mori_trace_next": 6, "mori_trace_seq": 6, "mori_trace_span": 6, "moriall2allmanag": 2, "most": 0, "move": 4, "mpi": [2, 5], "msgsize": 3, "multi": [2, 11], "multipl": [4, 6, 11], "multiprocess": 2, "must": [2, 4, 5, 6], "my": 5, "my_kernel": 6, "my_kernel_profiler_init_context": 6, "my_p": 5, "my_rank": 5, "mykernelarg": 6, "mykernellaunch": 6, "mykernelslot": 6, "n": [5, 10], "name": [2, 5, 6, 8, 10], "namespac": 6, "nativ": 9, "nbyte": 5, "nccl": [2, 5, 11], "necessari": [4, 6], "need": [0, 4, 5, 6], "neither": 0, "network": [1, 2, 4], "new": [5, 6], "next": [0, 6, 9], "nic": [2, 3, 5, 9], "nnode": [1, 2, 3], "node": [3, 5, 9, 11], "node_rank": [1, 2, 3], "non": 5, "none": [0, 2], "note": [0, 2, 6], "notif": 4, "now": 6, "npe": 5, "nproc": 2, "nproc_per_nod": [1, 2, 3], "npytorch": 10, "num": 3, "num_ev": 4, "num_experts_per_rank": 2, "num_experts_per_token": 2, "num_qp": 5, "num_qp_per_p": 2, "num_rank": 5, "num_stream": 4, "num_token": 2, "num_worker_thread": 4, "numactl": 3, "number": [1, 2, 3, 4, 5], "o": [0, 2, 9, 11], "object": [4, 6], "occur": 4, "off": [2, 6], "offset": [5, 6], "offset_buff": 6, "onc": [4, 5], "one": [4, 5, 6], "onli": [0, 1, 2, 5, 6], "op": [0, 1, 2, 3, 6, 7, 10, 11], "open": 6, "openshmem": [0, 5], "oper": [0, 3, 4, 5, 6, 8, 9, 11], "opt": 10, "optim": [0, 2, 9], "option": [1, 6], "org": 10, "origin": 2, "other": [4, 5], "out": 6, "output": [0, 1, 2, 7, 8, 11], "output_tensor": [7, 11], "over": 4, "overhead": [4, 6], "overlap": [2, 6], "overrid": [2, 6], "overview": 9, "own": 4, "p2p": [0, 2, 4], "packed_recv_count": 2, "packed_recv_layout_rang": 2, "packed_recv_src_info": 2, "packed_recv_x": 2, "page": 9, "pair": [2, 3, 4, 5], "parallel": [0, 2, 7], "paramet": [2, 6, 7], "pars": 6, "parti": 4, "particip": [4, 5], "pass": [2, 4, 6], "path": [1, 2, 3, 4, 8, 10], "pattern": 6, "pe": 2, "penalti": 4, "pensando": 2, "per": [2, 3, 4, 5, 6, 11], "perfetto": [0, 2, 6], "perform": [0, 1, 4, 6, 8, 9], "perspect": 4, "phase": [2, 6], "phase1": 6, "phase2": 6, "physcpubind": 3, "pip": [0, 2, 6], "pipelin": 2, "plane": 4, "platform": 9, "point": [0, 2, 4, 7], "pointer": [4, 5], "poll": [3, 4], "poll_cq_mod": [3, 4], "pollcqmod": 4, "pop_inbound_transfer_statu": 4, "port": [2, 4], "posit": 2, "post_batch_s": 4, "power": 5, "practic": 9, "pre": [2, 4, 5], "prefix": 1, "prepar": 2, "preprocessor": 6, "previou": 6, "primari": 4, "primit": [0, 9], "print": [2, 10, 11], "printf": 2, "prioriti": 2, "process": 7, "produc": 6, "product": [0, 6, 7], "profil": 9, "profilerconfig": 6, "progress": 4, "project": 6, "protocol": 4, "provid": [0, 2, 4, 5, 7], "ptr": [4, 5], "public": [2, 4, 5], "purpos": 0, "py": [0, 1, 2, 3, 4, 5, 6, 10], "pybind": [2, 4, 5], "python": [1, 2, 3, 5, 8, 9, 10], "python3": [1, 2, 10], "pythonpath": [1, 3], "pytorch": [0, 4, 10], "qp": [3, 4], "qp_per_transf": 4, "quantiz": 2, "queri": [4, 6], "queue": [2, 3, 4, 5], "quickstart": 9, "r": 0, "r_offset": 4, "raii": 6, "rais": 2, "rand": 2, "randint": 4, "randn": [2, 7, 11], "random": 2, "randperm": 2, "rang": [2, 11], "rank": [1, 2, 3, 5, 6, 7, 11], "rate": 6, "raw": 4, "rdma": [0, 1, 2, 4, 5, 9, 11], "rdma_block_num": 2, "rdma_config": 4, "rdmabackendconfig": 4, "reach": 5, "read": 9, "readi": 4, "realiti": 0, "rebuild": [2, 6], "receiv": [1, 2, 7], "recommend": [6, 10], "reconstruct": 2, "record": 6, "recurs": 10, "recv": [0, 9], "recv_count": 2, "recv_num_token": 2, "recv_token": 2, "reduc": [0, 4, 9, 11], "reduce_scatt": [0, 7], "reduceop": [0, 7, 11], "reduct": 7, "region": [4, 5, 6], "regist": [2, 4, 6], "register_memori": 4, "register_remote_engin": 4, "register_torch_tensor": 4, "registr": 4, "reli": 6, "remot": [4, 5], "remote_mem": 4, "remote_ptr": 5, "remov": [0, 4, 6], "remove_backend": 4, "repeat": 4, "repetit": 4, "replac": [0, 1, 2, 3], "report": 2, "repositori": [0, 10], "repres": 4, "requir": [2, 9, 11], "reserv": 5, "resourc": 4, "respons": 4, "result": [2, 4, 9, 11], "return": [2, 4, 5], "reusabl": 4, "rewritten": 0, "roce": 1, "rocm": [2, 9, 10], "rocm_path": 10, "rocminfo": 10, "root": 0, "rout": [0, 2], "row": 6, "run": [0, 1, 2, 3, 6], "run_ep": 2, "runtim": 5, "runtimeerror": [2, 10], "same": [2, 3, 5], "save": [9, 11], "save_result": [0, 8, 11], "scale": 2, "scale_dim": 2, "scale_type_s": 2, "scan": 6, "scatter": [0, 9], "scope": [0, 6], "script": 6, "search": 9, "section": [4, 5], "see": [2, 4, 6, 10, 11], "select": [2, 5, 6, 9], "send": [0, 9], "sent": 2, "separ": 2, "seq": 6, "sequenti": 6, "seri": 10, "server": 4, "sess": [3, 4], "session": [3, 4], "set": [1, 2, 3, 4, 5, 6, 8], "set_devic": 2, "set_log_level": [0, 4, 8], "set_output_dir": [0, 8], "setup": [0, 2, 4, 6, 10, 11], "sever": [0, 2], "sglang": 2, "shape": 11, "share": [5, 6], "shmem": [0, 2, 10], "shmem_barrier_al": 5, "shmem_buffer_deregist": 5, "shmem_buffer_regist": 5, "shmem_ext_malloc_with_flag": 5, "shmem_fin": [2, 5], "shmem_fre": 5, "shmem_get_unique_id": [2, 5], "shmem_init_attr": [2, 5], "shmem_malloc": 5, "shmem_malloc_align": 5, "shmem_module_init": 5, "shmem_myp": 5, "shmem_np": 5, "shmem_num_qp_per_p": 5, "shmem_ptr_p2p": 5, "shmem_torch_process_group_init": [0, 2, 5], "should": [0, 1], "show": [0, 4, 6], "side": [2, 4], "simpl": 5, "simplest": 6, "simpli": 6, "simul": 2, "singl": [2, 3, 6], "size": [2, 4, 5, 8, 9], "size_byt": 8, "size_in_byt": 5, "slot": 6, "slow": 4, "small": [2, 6, 11], "smi": 10, "so": 6, "socket": 1, "sonnet": 0, "sourc": [0, 6, 7, 9], "span": 6, "spawn": 2, "specif": [1, 2, 4, 6], "specifi": [1, 2], "src": [2, 4, 5, 6, 7], "src_rank": 2, "src_tensor": 4, "src_token_id": 2, "src_token_po": 2, "stack": 2, "stage": 6, "standard": [5, 8], "start": [0, 3, 11], "state": [2, 4, 5, 6], "statu": [0, 4, 5, 9], "statuscod": 4, "step": [0, 9], "still": [4, 6], "stop": [0, 8, 11], "store": [4, 6], "str": 4, "string": 6, "struct": 6, "style": [0, 5], "succeed": 4, "success": [4, 5], "successfulli": [4, 10], "suggest": 0, "suit": 4, "sum": [0, 7, 11], "sunway513": 9, "support": [2, 4, 6, 10], "symbol": 5, "symmetr": [0, 2], "synchron": [0, 2, 6, 7], "system": 6, "t": [0, 6], "taken": 2, "target": [3, 4], "target_desc": 4, "target_mem": 4, "tcp": [1, 2, 4, 5], "templat": 6, "tensor": [2, 4, 5, 7, 8, 11], "test": [0, 1, 2, 3, 4], "test_dispatch_combin": 2, "test_dispatch_combine_internod": [1, 2], "test_engin": 4, "them": [2, 4], "thi": [0, 2, 4, 5, 6, 7, 11], "thor2": [2, 9], "thread": [2, 3], "threadidx": 6, "three": 0, "through": [2, 6], "throughput": 2, "time": 2, "timelin": 6, "timestamp": 8, "tip": 9, "togeth": 4, "token": [0, 1, 2], "too": 6, "tool": [0, 6, 8, 9, 11], "top": 2, "topologi": 2, "torch": [0, 2, 4, 5, 7, 10, 11], "torchrun": [1, 2, 3], "total": [0, 1, 2, 5], "total_p": 5, "total_recv": 2, "totals": 3, "trace": [0, 2, 8], "trace_buff": [2, 6], "train": [0, 7, 9], "transfer": [0, 2, 3, 4], "transferstatu": 4, "transport": [2, 4, 5], "troubleshoot": 9, "true": [2, 4], "try": 6, "tune": 2, "tupl": 2, "tutori": 0, "two": [2, 3, 4, 5], "type": [3, 4], "typenam": 6, "typic": [2, 4, 6], "u": 3, "ui": [2, 6], "uid": 4, "uint8": 4, "underscor": 6, "understand": 11, "uniqu": [4, 6], "unique_id": [2, 5], "unknown": 4, "unless": 2, "until": [4, 5], "up": 6, "updat": 0, "upon": 5, "uppercase_filenam": 6, "us": [1, 2, 3, 4, 5, 6, 8, 11], "usag": [0, 4, 6, 7], "use_bnxt": 2, "use_external_inp_buf": 2, "use_ion": 2, "use_rocm": 2, "util": 4, "v": [2, 6], "v0": 2, "v1": 2, "v1ll": 2, "valu": [2, 4, 5, 6], "variabl": [1, 6, 9], "variant": 2, "verbos": 4, "veri": 7, "verif": [2, 9], "verifi": 10, "version": 10, "via": [2, 5, 10], "view": 8, "virtual": 5, "visibl": 6, "visual": [0, 2, 9, 11], "viz": [9, 11], "vllm": 2, "void": 6, "wa": 2, "wait": 4, "wall_clock64": 6, "want": 1, "warp": [0, 2, 6], "warp_num_per_block": 2, "warp_per_block": 2, "warpsiz": 6, "weight": 2, "what": [2, 5], "when": [2, 3, 5, 6], "where": [4, 6], "whether": 6, "which": [1, 5, 6], "while": 4, "why": 6, "within": [2, 6], "without": [4, 5, 6], "work": [0, 6], "worker": 3, "workflow": 9, "world": [2, 5], "world_group": [2, 5], "world_siz": [2, 5, 11], "would": 6, "wrap": [2, 6], "wraparound": 6, "wrapper": 6, "write": [6, 9], "written": 6, "x": 6, "xgmi": [1, 2, 4, 5], "xgmibackendconfig": 4, "ye": 2, "you": [1, 6, 11], "your": [3, 5, 6, 8, 10, 11], "zero": [2, 4, 5, 6], "zero_": 6, "zeros_lik": 11}, "titles": ["MORI Documentation Accuracy Audit Report", "MORI-EP Benchmark", "MORI-EP User Guide", "MORI-IO Benchmark", "MORI-IO Introduction", "MORI Shmem Guide", "MORI-VIZ (Visualizer)", "Communication Operations", "Profiler", "MORI Documentation", "Installation", "Quickstart"], "titleterms": {"1": [0, 2, 3, 5, 6], "10": 2, "11": 2, "2": [0, 2, 5, 6], "3": [0, 2, 5, 6], "4": [0, 2, 5], "5": [0, 2, 5], "6": [2, 5], "7": [2, 5], "8": [2, 5], "9": 2, "NOT": 0, "No": 2, "accuraci": 0, "actual": 0, "add": 6, "address": 5, "advanc": 8, "all": [0, 7, 11], "alloc": 5, "analysi": 6, "analyz": 8, "api": [0, 2, 4, 5, 9], "architectur": 4, "argument": 3, "audit": 0, "auto": 2, "barrier": 7, "basic": [4, 11], "batch": 3, "benchmark": [1, 2, 3], "best": 6, "broadcast": 7, "buffer": 5, "build": [2, 6], "characterist": 7, "code": [0, 6], "collect": 0, "combin": 2, "combine_standard_mo": 2, "command": 3, "commun": [0, 7, 11], "compat": 2, "complet": [0, 2], "concept": [4, 5], "config": 2, "configur": [2, 4], "content": [1, 2, 3, 4, 5, 6], "context": [6, 8], "convert_combine_input": 2, "convert_dispatch_output": 2, "critic": 0, "cx7": 3, "deepep": 2, "deepseek": 2, "default": 2, "defin": 6, "descript": 0, "design": 4, "devic": 6, "dispatch": 2, "dispatch_standard_mo": 2, "distribut": 2, "doc": 0, "document": [0, 9], "doe": 0, "elaps": 6, "element": 5, "enabl": 6, "entir": 0, "environ": [2, 4, 5, 10], "ep": [1, 2], "epdispatchcombineconfig": 2, "epdispatchcombineop": 2, "exampl": [0, 2, 4, 11], "execut": 0, "exist": [0, 5], "featur": [0, 8, 9], "file": [0, 2, 4, 5], "final": 5, "fix": 0, "flag": 5, "framework": 2, "free": 5, "from": 10, "function": 0, "gather": [7, 11], "gener": 6, "get": 9, "get_dispatch_src_token_po": 2, "get_registered_combine_input_buff": 2, "gpu": 9, "group": [2, 5], "guid": [2, 5], "header": 6, "heap": 5, "help": 9, "high": 0, "hip": 5, "id": [2, 5], "immedi": 0, "includ": 6, "index": 0, "indic": 9, "init": 5, "initi": [2, 5], "instal": [0, 10], "instrument": 6, "integr": [2, 5], "inter": [1, 2], "intra": [1, 2], "introduct": 4, "io": [3, 4], "issu": 0, "kernel": 2, "launch": 2, "link": 9, "low": 0, "manag": [5, 8], "manual": 2, "measur": 6, "medium": 0, "memori": 5, "messag": 3, "method": [2, 5, 10], "mislead": 0, "mismatch": 0, "mode": 2, "modul": 5, "moe": 2, "mori": [0, 1, 2, 3, 4, 5, 6, 9], "next": 11, "nic": 1, "node": [1, 2], "non": 0, "oper": [2, 7], "option": 2, "overview": 6, "p0": 0, "p1": 0, "p2": 0, "p2p": 5, "p3": 0, "pe": 5, "perform": [2, 7, 11], "point": 6, "practic": 6, "prioriti": 0, "process": [2, 5], "profil": [0, 2, 6, 8, 11], "python": [0, 4, 6], "pytorch": [2, 5], "queri": 5, "quick": [2, 4, 5, 9], "quickstart": [0, 11], "rdma": 3, "read": [3, 4], "recommend": [0, 2, 5], "recv": [2, 7], "reduc": 7, "refer": [0, 2, 4, 5, 9], "regist": 5, "report": 0, "requir": [0, 10], "reset": 2, "result": [3, 8], "review": 0, "rewrit": 0, "rst": 0, "save": 8, "scatter": 7, "select": 1, "send": [2, 7], "shmem": 5, "side": 6, "size": 3, "sourc": [2, 4, 5, 10], "split": 2, "standalon": 5, "standard": 2, "start": [8, 9], "statist": 0, "step": 11, "summari": 0, "support": 9, "sweep": 3, "symmetr": 5, "synchron": 5, "tabl": [1, 2, 3, 4, 5, 6, 9], "thor2": 3, "time": 6, "tip": 11, "trace": 6, "translat": 5, "triton": 5, "troubleshoot": 10, "txt": 0, "type": 2, "uniqu": [2, 5], "us": 0, "user": 2, "v3": 2, "variabl": [2, 5, 10], "verif": [0, 10], "version": 0, "view": 6, "visual": [6, 8], "viz": [2, 6], "what": 0, "workflow": 4, "write": [3, 4], "wrong": 0}})